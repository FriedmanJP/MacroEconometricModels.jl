<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Bayesian Historical Decomposition (cholesky)</title>
<style>* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
    background: #fff;
    color: #333;
    padding: 20px;
}
.figure-title {
    font-size: 18px;
    font-weight: 600;
    text-align: center;
    margin-bottom: 16px;
    color: #222;
}
.figure-source {
    font-size: 11px;
    color: #888;
    text-align: center;
    margin-top: 8px;
}
.panel-grid {
    display: flex;
    flex-wrap: wrap;
    gap: 16px;
    justify-content: center;
}
.panel {
    width: calc(100% - 16px);
    min-width: 300px;
    background: #fff;
    border: 1px solid #e0e0e0;
    border-radius: 4px;
    padding: 12px;
}
.panel-title {
    font-size: 13px;
    font-weight: 600;
    text-align: center;
    margin-bottom: 8px;
    color: #444;
}
.axis text { font-size: 11px; fill: #666; }
.axis line, .axis path { stroke: #ccc; }
.grid line { stroke: #f0f0f0; stroke-dasharray: 2,2; }
.grid .domain { stroke: none; }
.tooltip {
    position: absolute;
    background: rgba(0,0,0,0.8);
    color: #fff;
    padding: 6px 10px;
    border-radius: 4px;
    font-size: 11px;
    pointer-events: none;
    opacity: 0;
    transition: opacity 0.15s;
    z-index: 1000;
}
.legend { font-size: 11px; }
.legend rect { rx: 2; }
svg { overflow: visible; }
</style>
</head>
<body>
<div class="figure-title">Bayesian Historical Decomposition (cholesky)</div>
<div class="panel-grid">
<div class="panel">
<div class="panel-title">INDPRO — Posterior Mean Contributions</div>
<div id="bhd_bar_55"></div>
</div>
<div class="panel">
<div class="panel-title">INDPRO — Actual vs Decomposition</div>
<div id="bhd_line_56"></div>
</div>
<div class="panel">
<div class="panel-title">UNRATE — Posterior Mean Contributions</div>
<div id="bhd_bar_57"></div>
</div>
<div class="panel">
<div class="panel-title">UNRATE — Actual vs Decomposition</div>
<div id="bhd_line_58"></div>
</div>
<div class="panel">
<div class="panel-title">CPI — Posterior Mean Contributions</div>
<div id="bhd_bar_59"></div>
</div>
<div class="panel">
<div class="panel-title">CPI — Actual vs Decomposition</div>
<div id="bhd_line_60"></div>
</div>
</div>

<div class="tooltip" id="tooltip"></div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
<script>
// Shared utilities
const tooltip = d3.select('#tooltip');
function fmt(v) {
    if (v === null || v === undefined) return '';
    return Math.abs(v) >= 1000 ? v.toFixed(1) : (Math.abs(v) >= 1 ? v.toFixed(3) : v.toFixed(4));
}
function showTip(evt, html) {
    tooltip.html(html).style('opacity',1)
        .style('left',(evt.pageX+12)+'px').style('top',(evt.pageY-28)+'px');
}
function hideTip() { tooltip.style('opacity',0); }

(function() {
    const data = [{"x":1,"s1":0.0009385838765330274,"s2":0.0,"s3":0.0},
{"x":2,"s1":0.0035856757002991173,"s2":0.00010014612399482706,"s3":-0.0004504444316828343},
{"x":3,"s1":-0.00038263172399721627,"s2":0.0010051633637376972,"s3":0.0004529637813063369},
{"x":4,"s1":0.009070383432943103,"s2":0.0002787065905197042,"s3":-0.0018150688096127952},
{"x":5,"s1":0.0002790437078956931,"s2":-0.0008471307868033237,"s3":-0.0014502939636167839},
{"x":6,"s1":0.002219733279219595,"s2":-0.0015236411719910445,"s3":0.0003747941076898026},
{"x":7,"s1":-0.0056110678605259,"s2":0.0037249091344920522,"s3":-0.0021612828759933755},
{"x":8,"s1":-0.0011321215417050292,"s2":0.001445938233525543,"s3":0.001238887404774766},
{"x":9,"s1":-0.0030953465399825237,"s2":-0.001007546073575109,"s3":-0.001371499894471183},
{"x":10,"s1":0.0009334427018087466,"s2":-0.003037723891174321,"s3":0.001000464627573399},
{"x":11,"s1":-0.0076747017225339215,"s2":0.005522735607757364,"s3":-0.0023104337193932166},
{"x":12,"s1":-0.0027669346025408956,"s2":0.0021320185695137203,"s3":0.0007819741728971422},
{"x":13,"s1":-0.008804462592518977,"s2":0.0011486127761157865,"s3":0.003122533338889674},
{"x":14,"s1":-0.0011914505959083291,"s2":0.003822307272773691,"s3":-0.0010318205448497327},
{"x":15,"s1":-0.008300085461163401,"s2":-0.0033424732600194434,"s3":0.002629141452800651},
{"x":16,"s1":-0.0012028430351523408,"s2":0.0013490688218344216,"s3":-0.0016212429926902613},
{"x":17,"s1":0.0011218491665302467,"s2":0.00243660680524852,"s3":0.0009085399509541722},
{"x":18,"s1":0.0012519110757206132,"s2":0.006102597579177162,"s3":-0.0019501621915238348},
{"x":19,"s1":-0.001931167733124841,"s2":0.00013432835619357257,"s3":0.0003543170454225981},
{"x":20,"s1":-0.007171018309669625,"s2":-0.004987021473761346,"s3":0.0028245568133033095},
{"x":21,"s1":-0.004853076512183095,"s2":0.003993355106418027,"s3":-0.004729568827558078},
{"x":22,"s1":-0.00467535199718063,"s2":0.0011835475732995767,"s3":-0.003105073199180321},
{"x":23,"s1":-0.01428631670326282,"s2":0.003682166948518069,"s3":0.0008049385029361327},
{"x":24,"s1":-0.007269591244572694,"s2":-0.0038882303584762204,"s3":-0.00025275522303248047},
{"x":25,"s1":-0.012224800698439132,"s2":-0.004289003770355224,"s3":0.0008160842252037982},
{"x":26,"s1":0.004839290856826906,"s2":-0.00015416649353059594,"s3":-0.0020187141325295897},
{"x":27,"s1":-0.006424854944042314,"s2":0.003978648040246506,"s3":-0.0027479778756544985},
{"x":28,"s1":-0.00978687844612655,"s2":-0.0037754890162576583,"s3":0.0022809459540590916},
{"x":29,"s1":0.0015359763490421104,"s2":0.0020309873431396033,"s3":-0.0007502802035770362},
{"x":30,"s1":0.0049531736015012325,"s2":-0.0027502735505854758,"s3":0.0015218479091218856},
{"x":31,"s1":-0.005604526690107012,"s2":-0.0025526531261380585,"s3":-0.0015805349804628391},
{"x":32,"s1":0.004531703316483334,"s2":0.001989777184881843,"s3":-0.0035488657943233675},
{"x":33,"s1":0.000851911101636778,"s2":-0.00011563075072597062,"s3":0.0015817444487187578},
{"x":34,"s1":-0.005114291213083656,"s2":-7.267087611708816e-5,"s3":-0.0012698510023591175},
{"x":35,"s1":-0.0029388945676893834,"s2":0.0005494736693792571,"s3":0.004183882523951762},
{"x":36,"s1":-0.0022308146190810276,"s2":-0.004950988258422332,"s3":0.0016663977149094776},
{"x":37,"s1":-0.006164633715524991,"s2":-0.0008899912439011555,"s3":3.890365006261481e-5},
{"x":38,"s1":0.0024218881128685436,"s2":-0.0009693977727426621,"s3":0.0019237854065847016},
{"x":39,"s1":-0.004244364198091203,"s2":-0.009077815003415785,"s3":0.0036154385347430132},
{"x":40,"s1":-0.008826457376815157,"s2":-0.006083194482222845,"s3":-9.129677576671561e-5},
{"x":41,"s1":-0.019553648124504323,"s2":0.001893685561067182,"s3":0.002128230191746528},
{"x":42,"s1":-0.009582643945047195,"s2":0.003490401691391669,"s3":-0.0024730704091850903},
{"x":43,"s1":-0.0071981534345852295,"s2":-0.00486669174871238,"s3":0.0030959043912009362},
{"x":44,"s1":-0.011480170279759196,"s2":-0.004814024948732327,"s3":0.00042952415431038964},
{"x":45,"s1":-0.006437422168653229,"s2":-0.0015090337784664349,"s3":-0.001629641121645621},
{"x":46,"s1":0.0005039445702450807,"s2":-0.0036829863879011106,"s3":0.0017803271416683},
{"x":47,"s1":0.006697379965298095,"s2":-0.0015682509104902606,"s3":0.003113137968581167},
{"x":48,"s1":0.00962162331574542,"s2":-0.001465707926250167,"s3":0.000813958595406353},
{"x":49,"s1":0.0034661689726577464,"s2":-0.00268832007224991,"s3":-0.0012602165236762068},
{"x":50,"s1":-0.0008429295033598155,"s2":-0.003655626302081165,"s3":0.002826083705860458},
{"x":51,"s1":0.005164973130417118,"s2":-0.00379237856213717,"s3":0.0033509857741488795},
{"x":52,"s1":-0.004406841812798488,"s2":0.0009033348302324288,"s3":-0.0027276831325831158},
{"x":53,"s1":-0.006300548162070136,"s2":-0.0040141121915215645,"s3":0.003420597036345915},
{"x":54,"s1":-0.0073483454984066415,"s2":-0.0016115178926042761,"s3":0.0010312512807503754},
{"x":55,"s1":-0.010276813535641091,"s2":0.003187397837976647,"s3":0.0008926037008507839},
{"x":56,"s1":0.006557261875703926,"s2":-0.00558963822306438,"s3":0.0012327379946082062},
{"x":57,"s1":0.0022202862677706187,"s2":0.0035262186662986215,"s3":0.00022440718179056495},
{"x":58,"s1":0.004490959519628511,"s2":0.0015321183032099076,"s3":-0.001049646401085539},
{"x":59,"s1":0.0006047744562682168,"s2":0.000467022353544911,"s3":-0.0006335174645508037},
{"x":60,"s1":-8.54514716140176e-5,"s2":-0.003314373702092517,"s3":-0.0009069788692026814},
{"x":61,"s1":0.00879504360770613,"s2":-0.0069214879535647745,"s3":0.0004215626267677666},
{"x":62,"s1":-0.00224126053757994,"s2":-0.004755708736900991,"s3":-0.0018936251573448224},
{"x":63,"s1":-0.0018411282312695433,"s2":0.0034348031482594674,"s3":0.0018383410164873656},
{"x":64,"s1":0.001078160706676862,"s2":0.0035305567638710925,"s3":0.0029302742362518454},
{"x":65,"s1":-0.004236181139231615,"s2":-0.0014733670482532592,"s3":0.0026430328977026874},
{"x":66,"s1":0.0023925489256623566,"s2":0.003037411164858556,"s3":-0.001509236894758908},
{"x":67,"s1":-0.007441054480319984,"s2":-0.0020598022312519346,"s3":0.0021667263440945774},
{"x":68,"s1":0.000515092227405483,"s2":-0.0021640976480164233,"s3":-0.0005255975279860692},
{"x":69,"s1":-0.005488849225245063,"s2":0.0031855770726378946,"s3":0.000726483294107211},
{"x":70,"s1":-0.0035396092362592717,"s2":0.008575432270394819,"s3":-0.0036862665416135584},
{"x":71,"s1":-0.012515297839931164,"s2":-0.001154756925927445,"s3":0.002445176089943646},
{"x":72,"s1":-0.0026956988501095213,"s2":-0.0005373378718437735,"s3":0.0024337032838287996},
{"x":73,"s1":-0.0029501405024503036,"s2":0.0013010981567293058,"s3":-0.004189566343822667},
{"x":74,"s1":-0.004202274258995819,"s2":0.004356060366082815,"s3":-0.0022487516104695822},
{"x":75,"s1":-0.003486410512637427,"s2":0.005515741291892589,"s3":-0.0008694316895415527},
{"x":76,"s1":-0.00052517874888619,"s2":0.0024069722891027715,"s3":-0.00028886811412977444},
{"x":77,"s1":0.0024939568360778023,"s2":0.0007828976606868483,"s3":-0.0030730506972567696},
{"x":78,"s1":0.0009191801911919248,"s2":0.0031455352871099466,"s3":-0.0044142007530618855},
{"x":79,"s1":-0.0022286485539159263,"s2":0.0031268573505874096,"s3":0.0006060606381516301},
{"x":80,"s1":-0.0034080077008165305,"s2":0.0007856578942696463,"s3":-0.00011584471204673486},
{"x":81,"s1":0.005666758958561679,"s2":-0.0036605245621687023,"s3":0.0028475163620071547},
{"x":82,"s1":0.0007148191673778603,"s2":-0.0037375010372773386,"s3":0.0005567631443407118},
{"x":83,"s1":-0.0027183201790143456,"s2":0.0037882105315606646,"s3":-0.001229756791499289},
{"x":84,"s1":-0.0011131432533898003,"s2":0.00591893927624271,"s3":-0.0018019936628486236},
{"x":85,"s1":-0.005283679199214906,"s2":0.002278038289202913,"s3":0.0017447138791781764},
{"x":86,"s1":0.0004464054759867627,"s2":0.0015867047021369926,"s3":-0.0013079685688921813},
{"x":87,"s1":-0.0022100078586282067,"s2":-0.0012834485372785448,"s3":0.0015882695589052808},
{"x":88,"s1":0.001603150414451348,"s2":0.0037804445148791276,"s3":-0.0001192057406549995},
{"x":89,"s1":0.0005170658759321358,"s2":0.006475424100249611,"s3":-0.003795350955597218},
{"x":90,"s1":0.0047323482260584575,"s2":0.002795049625901447,"s3":-0.00281913915373531},
{"x":91,"s1":-0.003846080403454942,"s2":0.00459678932418851,"s3":0.0007088979611342},
{"x":92,"s1":-0.007326243583035685,"s2":0.00034264470412657407,"s3":-0.0003931491333424957},
{"x":93,"s1":-0.005110248569348816,"s2":7.950945579124558e-5,"s3":0.0013583732067794217},
{"x":94,"s1":-0.0040486002198985415,"s2":0.0003034980827820586,"s3":-0.0014501176742881161},
{"x":95,"s1":-0.000849960325502143,"s2":0.0006769421633794842,"s3":0.0005106653251299129},
{"x":96,"s1":-0.004203972421394411,"s2":-0.009395629576470381,"s3":-3.441433611233107e-5},
{"x":97,"s1":-0.006919370125034702,"s2":0.001595325702782045,"s3":-0.0013965372155187357},
{"x":98,"s1":0.004438982728659227,"s2":0.003429256005148745,"s3":-0.000987610061135683},
{"x":99,"s1":-0.0010109606232188092,"s2":-0.0016318533918255928,"s3":0.0035604508883297593},
{"x":100,"s1":-0.0021092672511249045,"s2":-0.0062163921467226525,"s3":0.002636770466721626},
{"x":101,"s1":-0.0037693419978293697,"s2":0.0048102922681523535,"s3":-0.00332957355684274},
{"x":102,"s1":-0.003357925900055571,"s2":0.0008500336398551845,"s3":0.0006331555581323505},
{"x":103,"s1":-0.009576894851074436,"s2":0.0011392986775625332,"s3":0.001508416093376339},
{"x":104,"s1":0.012095296622111059,"s2":0.0021383353949536114,"s3":-0.0021234965002915294},
{"x":105,"s1":-0.007513594188109181,"s2":0.0011515483610411688,"s3":0.002663216245577555},
{"x":106,"s1":0.007658585821335818,"s2":0.002033770404812222,"s3":-0.003637100235209075},
{"x":107,"s1":0.0031446694764977255,"s2":-0.0023423753519153413,"s3":0.0021082352305418044},
{"x":108,"s1":0.002240058304965129,"s2":-0.0018534034545493296,"s3":-0.0016159083393858884},
{"x":109,"s1":-0.002368909459567225,"s2":0.0035346390035673517,"s3":-0.002480331871822693},
{"x":110,"s1":-0.0028553080048865963,"s2":0.0011914556195884033,"s3":0.0013233238281657857},
{"x":111,"s1":-0.004319536928685296,"s2":0.001877165711298937,"s3":-0.0002439664593877032},
{"x":112,"s1":-0.006317086677915321,"s2":0.00923566186964678,"s3":-0.0005583677996381424},
{"x":113,"s1":-0.0011365509744436881,"s2":-0.0023492428006116756,"s3":0.0025296248283690776},
{"x":114,"s1":0.0056895609735855245,"s2":-0.003076964848695329,"s3":-0.001536273353397771},
{"x":115,"s1":-0.002158045262494859,"s2":-0.007010053811256486,"s3":0.0018037908654073198},
{"x":116,"s1":0.006529581640679538,"s2":0.0026880447428578227,"s3":-0.0020262978095172465},
{"x":117,"s1":7.317282064371101e-5,"s2":0.0009448234766106472,"s3":0.0010840857746603828},
{"x":118,"s1":-0.0031164115898832806,"s2":0.002031966668914711,"s3":-4.45192531075587e-5},
{"x":119,"s1":-0.0017814685533546525,"s2":0.0014154474094802134,"s3":0.00033532905421569545},
{"x":120,"s1":-0.0013070015984967963,"s2":0.005125348506750338,"s3":-0.002161992966513421},
{"x":121,"s1":0.004446758610814776,"s2":0.0016433032885354356,"s3":0.0012644420216117941},
{"x":122,"s1":0.005179536240667184,"s2":0.0010212959097670978,"s3":0.0005927774763365083},
{"x":123,"s1":0.0036804118578149343,"s2":-0.0016079026131251228,"s3":0.0007251723556549217},
{"x":124,"s1":0.006720803817318467,"s2":-5.170277340816974e-5,"s3":0.0016369594903560252},
{"x":125,"s1":-0.0004759752880946782,"s2":0.0008336896809836136,"s3":0.00014549053585096258},
{"x":126,"s1":0.0012957756270886044,"s2":-0.0016647791725539981,"s3":0.0011996344557077317},
{"x":127,"s1":-0.0013897353758828036,"s2":0.0046694424388624345,"s3":0.00030919410461943583},
{"x":128,"s1":-0.005394316378890186,"s2":-0.0002307335352986062,"s3":0.0006031409300476831},
{"x":129,"s1":-0.003123180639080319,"s2":-0.001665166308144195,"s3":0.002392080560656928},
{"x":130,"s1":-0.0038184581445899817,"s2":0.0053715803721837135,"s3":-0.0016110241117358668},
{"x":131,"s1":-0.0026883564357339145,"s2":0.003153569191279063,"s3":0.0012180095804409767},
{"x":132,"s1":-0.00977907612306345,"s2":0.004850597210960017,"s3":-0.002652154877180296},
{"x":133,"s1":-0.011201635558954657,"s2":0.0019795156349753954,"s3":-0.0011434687868957614},
{"x":134,"s1":0.01828115240192671,"s2":-0.005594550054876172,"s3":0.00022209291026412966},
{"x":135,"s1":-0.003398167163695613,"s2":-0.0044863581812094174,"s3":-0.0013424347381764906},
{"x":136,"s1":0.00536056509407436,"s2":0.00506288101523469,"s3":-0.004445384067812265},
{"x":137,"s1":-0.004054165465982038,"s2":-0.005325966932731944,"s3":0.0027034193872061767},
{"x":138,"s1":0.0011868946204058404,"s2":0.001230957711850256,"s3":3.002586394746995e-5},
{"x":139,"s1":0.001373681952267984,"s2":0.0005169798700299893,"s3":-0.0027716218393997257},
{"x":140,"s1":-0.0017060825162127087,"s2":-0.003741482840950939,"s3":0.00035710255257026524},
{"x":141,"s1":-0.003970833334998824,"s2":-0.0014730573616093567,"s3":0.0034005684246692655},
{"x":142,"s1":-0.0028111151259115627,"s2":0.004495211283711391,"s3":0.001672172892113361},
{"x":143,"s1":-0.0014495609132285279,"s2":-0.0014640810421636995,"s3":0.001305513091451938},
{"x":144,"s1":-0.004311381809701042,"s2":0.0018715619713585525,"s3":-0.0009003677818008042},
{"x":145,"s1":0.0010528254349185856,"s2":0.0010578129299064608,"s3":0.0009168339988017513},
{"x":146,"s1":-0.00018431405049087766,"s2":-0.00098232333656582,"s3":0.001213144922480588},
{"x":147,"s1":-0.008540578375811809,"s2":0.003999329450928749,"s3":-0.001550331144119163},
{"x":148,"s1":0.006760071362006085,"s2":-0.0008860268358822372,"s3":-0.0001290038459724858},
{"x":149,"s1":0.00024429013932948836,"s2":0.0035004332729133315,"s3":-0.0007235491799464669},
{"x":150,"s1":0.0001153650258052387,"s2":0.002223511546599515,"s3":0.00020859888113007328},
{"x":151,"s1":-0.0072742398502442795,"s2":-0.0010324539878002693,"s3":0.0014682166286983768},
{"x":152,"s1":-0.002093343184613697,"s2":0.0012179046588199883,"s3":-0.003915091505268639},
{"x":153,"s1":0.0013723810083878366,"s2":-0.00288832601614235,"s3":0.0018099127654267724},
{"x":154,"s1":0.00415784501392929,"s2":-0.0006448098193529619,"s3":-0.0009880718406513355},
{"x":155,"s1":-0.005809670012335481,"s2":0.0007824105793382859,"s3":0.0035740025847884344},
{"x":156,"s1":-0.008332991670862558,"s2":0.003197941864219927,"s3":0.0018877446538247034},
{"x":157,"s1":-0.007550535862956115,"s2":-0.0020264130062332027,"s3":0.0024064341339408686},
{"x":158,"s1":-0.001998797623258615,"s2":-0.004702552811649909,"s3":-0.001163676877847546},
{"x":159,"s1":0.001116953649696377,"s2":-0.0004477661749495045,"s3":0.002029386584543269},
{"x":160,"s1":-0.013484075992372047,"s2":-0.00048633225027751683,"s3":-0.001236428328452799},
{"x":161,"s1":-0.006063979047681744,"s2":0.003023499223707108,"s3":-0.00103489579918136},
{"x":162,"s1":-0.00891858956921942,"s2":0.004002050857622457,"s3":-0.002662881368474353},
{"x":163,"s1":-0.011845681597620145,"s2":-0.0008404776008270917,"s3":0.0003252727220040319},
{"x":164,"s1":-0.006899916553301755,"s2":-0.006150408263203096,"s3":0.0012987044403959722},
{"x":165,"s1":-0.006584055491023307,"s2":0.003036606649554495,"s3":-0.002227236511333939},
{"x":166,"s1":-0.0019422406375871532,"s2":-0.0011842825884798925,"s3":-0.001221442481810428},
{"x":167,"s1":-0.00930721911650879,"s2":0.001070946023630197,"s3":0.004128434746571453},
{"x":168,"s1":-0.012138931302884143,"s2":0.0010462000885871612,"s3":-0.0003939356553301244},
{"x":169,"s1":-0.0032971067217259188,"s2":-0.003147828238710699,"s3":0.0009052905048541457},
{"x":170,"s1":-0.0048029770787243915,"s2":0.00035060624648208425,"s3":-0.002510253028997725},
{"x":171,"s1":-0.00971556994280935,"s2":-0.005216224172824541,"s3":0.00222760512238215},
{"x":172,"s1":-0.0029573027587831736,"s2":-0.003245617097669102,"s3":0.0047207298749153345},
{"x":173,"s1":-0.006477446723613747,"s2":0.0014071766914984538,"s3":-0.00029174931252208335},
{"x":174,"s1":-0.002582169402094075,"s2":-0.006112539030471148,"s3":0.0019955897480601996},
{"x":175,"s1":0.002759234892253725,"s2":-0.002140806505391759,"s3":0.0029041720074303137},
{"x":176,"s1":-0.0011732805260712704,"s2":-0.0003626678144948941,"s3":-0.0005622883534028584},
{"x":177,"s1":0.004886936857120467,"s2":0.001387694613192768,"s3":-0.00048388539088056607},
{"x":178,"s1":0.0034708669804496446,"s2":-0.0030285789080447814,"s3":-0.0011400081994461134},
{"x":179,"s1":0.0027267110518399027,"s2":-0.0023635598816178814,"s3":0.0015321810913964656},
{"x":180,"s1":0.005516880532233606,"s2":-0.0029003904877313424,"s3":0.00031575998689336156},
{"x":181,"s1":-0.004491689789309774,"s2":0.0004950598114657387,"s3":0.0008117723031090356},
{"x":182,"s1":-0.004957294561860443,"s2":0.0018400819629384277,"s3":0.0004838316392229557},
{"x":183,"s1":-0.0032929659899095,"s2":0.00041266790766459737,"s3":0.0003956196753584413},
{"x":184,"s1":-0.006864026282529988,"s2":0.0008911367622781079,"s3":0.0009142041005921967},
{"x":185,"s1":0.0007195716483797848,"s2":0.0031183507412556087,"s3":-0.00028373740992301973},
{"x":186,"s1":-0.00765392505923921,"s2":-0.0058306090619011965,"s3":0.0018009809368937854},
{"x":187,"s1":0.003403469993078735,"s2":-0.0028493305271353646,"s3":0.0014649479184221529},
{"x":188,"s1":-0.004754801644916963,"s2":0.001592380786361402,"s3":-0.0012987378802751998},
{"x":189,"s1":-0.006299318894900171,"s2":-0.0007267457046759242,"s3":-0.0018852522646964852},
{"x":190,"s1":-0.00900911619644508,"s2":0.001917326602093511,"s3":-0.00017207592838414102},
{"x":191,"s1":-0.004005379385059113,"s2":-0.0015033437816692355,"s3":0.0020725615892328675},
{"x":192,"s1":0.000913976692982519,"s2":-0.005693944718301781,"s3":1.386722361199781e-5},
{"x":193,"s1":0.004738247708928003,"s2":-0.0011299307350725184,"s3":-0.0005915704227492797},
{"x":194,"s1":-0.001437355937462888,"s2":-0.0012671874940620063,"s3":0.0001868433170652058},
{"x":195,"s1":0.0037473805410660524,"s2":0.0020320569717786016,"s3":-0.0017214307651545915},
{"x":196,"s1":-0.0036609583494666663,"s2":0.0012375108384381293,"s3":-0.001966544129623332},
{"x":197,"s1":-0.0015226396033603976,"s2":-0.0016406894370227573,"s3":0.00452961960291393},
{"x":198,"s1":-0.0017398654290361813,"s2":-0.001847023114118572,"s3":-0.0020309731081206255},
{"x":199,"s1":-0.0037315762980087864,"s2":0.0038233130283267355,"s3":0.0011047963576078434},
{"x":200,"s1":0.0020900634833299525,"s2":-0.0023832241813675535,"s3":-0.0002567144638447111},
{"x":201,"s1":-0.008117822964961916,"s2":-0.00010922544622941428,"s3":0.002349532108634459},
{"x":202,"s1":-0.0029730015777292484,"s2":-6.96888673489458e-5,"s3":0.002324225565260213},
{"x":203,"s1":0.0013280220365348456,"s2":-0.0034720384411002516,"s3":0.00025587572763905255},
{"x":204,"s1":-0.013226032703062428,"s2":0.003841450156092904,"s3":-5.4015368143005396e-5},
{"x":205,"s1":-0.0013140082654221404,"s2":0.003386491704659734,"s3":-0.0001202708472556799},
{"x":206,"s1":-0.005660327735666002,"s2":0.005142296119217722,"s3":-0.004434823052546964},
{"x":207,"s1":-0.004957585517783436,"s2":0.0004882772047230988,"s3":0.0004208607147231481},
{"x":208,"s1":0.004246127494284983,"s2":0.0037848415034280637,"s3":-0.002826989781525706},
{"x":209,"s1":-0.0038123645047345714,"s2":-0.0038168321389840097,"s3":-0.0016201049075376},
{"x":210,"s1":0.0077548037598932605,"s2":-0.00315554092240654,"s3":0.00019940783879609925},
{"x":211,"s1":-0.0002628324543896363,"s2":0.0029235892716456195,"s3":0.00017086769124995138},
{"x":212,"s1":0.0022025647953570113,"s2":-0.0007530066912981061,"s3":0.0010916431682293972},
{"x":213,"s1":-0.002412712298930141,"s2":-0.0009597425411946624,"s3":-0.0006754076860119014},
{"x":214,"s1":-0.0016974813335104795,"s2":-0.000646402905555738,"s3":0.002059617593975066},
{"x":215,"s1":-0.0026929770799374716,"s2":0.001223759679751188,"s3":-0.0015774891727391594},
{"x":216,"s1":-0.0014069452835352287,"s2":0.0012966979135537128,"s3":0.0012569251010446417},
{"x":217,"s1":-0.011558945872364428,"s2":0.0013965834747618712,"s3":0.002328392478155575},
{"x":218,"s1":-0.0008690765990891204,"s2":-0.000623130321336429,"s3":9.071156029978444e-5},
{"x":219,"s1":-0.026497430336926378,"s2":0.008789539449476993,"s3":-0.0024635760709995533},
{"x":220,"s1":0.008715506856148688,"s2":-0.0016047584644047939,"s3":0.0001251974062730302},
{"x":221,"s1":0.0061954342627001755,"s2":-0.00047195321892084825,"s3":0.0019258997963427311},
{"x":222,"s1":-0.002521196416061864,"s2":0.003160161541150255,"s3":-0.0027204223560766674},
{"x":223,"s1":-0.003421145158507493,"s2":0.0024899851079649513,"s3":-0.0010717940308268314},
{"x":224,"s1":-0.004973819854475422,"s2":0.003581282967161178,"s3":-0.0021978488282671186},
{"x":225,"s1":-0.0021332281633537685,"s2":0.0017617232057216916,"s3":-0.0017840875756890665},
{"x":226,"s1":-0.0001329876048130572,"s2":-0.0008280126177663433,"s3":-0.002378198186457338},
{"x":227,"s1":-0.005462918768305243,"s2":-0.0004283360526309665,"s3":0.00036898422143298603},
{"x":228,"s1":-0.003853476979375504,"s2":0.0011790080100006876,"s3":0.0019787414014242853},
{"x":229,"s1":-0.0069622200683099236,"s2":0.0017807591279063767,"s3":-0.0009878410229405604},
{"x":230,"s1":-0.0005142587556559154,"s2":-0.0027558927298546804,"s3":0.0007744512357597379},
{"x":231,"s1":-0.008197238556045629,"s2":0.001976939339864704,"s3":0.00046515767531279863},
{"x":232,"s1":-0.006400933501549768,"s2":0.00011046265614263004,"s3":0.0007254584152588126},
{"x":233,"s1":-0.010174130399125413,"s2":0.009103115236137008,"s3":-0.0008886223497907743},
{"x":234,"s1":-1.203637580444509e-5,"s2":0.0026595746732095862,"s3":0.0006677004113083227},
{"x":235,"s1":-0.008188571918822574,"s2":-0.006084653129541359,"s3":-0.0014457122977062403},
{"x":236,"s1":0.005178540087172629,"s2":-0.000578677207919909,"s3":-0.0024360793016041647},
{"x":237,"s1":-0.009769221547335373,"s2":-0.00018178136386306378,"s3":-0.0022694471553501025},
{"x":238,"s1":0.005414366057539961,"s2":0.0015023673438206236,"s3":-0.002707619680251822},
{"x":239,"s1":-0.0038088481242428513,"s2":0.00019116057007888135,"s3":-0.0014958016295387108},
{"x":240,"s1":-0.007657459610412571,"s2":0.004263007187568293,"s3":-0.0001623500528488553},
{"x":241,"s1":-0.0026345971709369393,"s2":-0.0027859757798872537,"s3":0.0021621400508259805},
{"x":242,"s1":-0.0015563941192592422,"s2":-0.0023324649003209907,"s3":8.216022643177276e-5},
{"x":243,"s1":-0.002147922939930254,"s2":0.004886828723424531,"s3":-0.0018459670476992007},
{"x":244,"s1":-0.0037271927152814077,"s2":-0.0015468178130814427,"s3":0.00037793888947183226},
{"x":245,"s1":-0.004816261851887264,"s2":0.005296436721441926,"s3":0.00270149926045744},
{"x":246,"s1":8.617662338409557e-5,"s2":-0.0022997084385344762,"s3":-0.00031740003020288323}];
    const series = [{"name":"INDPRO","color":"#1f77b4","key":"s1","dash":""},{"name":"UNRATE","color":"#ff7f0e","key":"s2","dash":""},{"name":"CPI","color":"#2ca02c","key":"s3","dash":""}];
    const mode = 'stacked';

    const container = d3.select('#bhd_bar_55');
    const W = Math.max(container.node().clientWidth - 24, 280);
    const margin = {top:10, right:15, bottom:35, left:55};
    const w = W - margin.left - margin.right;
    const h = Math.min(w * 0.6, 250);

    const svg = container.append('svg').attr('width', W).attr('height', h + margin.top + margin.bottom);
    const g = svg.append('g').attr('transform', 'translate('+margin.left+','+margin.top+')');

    const keys = series.map(s => s.key);
    const x = d3.scaleBand().domain(data.map(d=>d.x)).range([0,w]).padding(0.15);

    let yMin = 0, yMax = 0;
    if(mode === 'stacked') {
        const stack = d3.stack().keys(keys).order(d3.stackOrderNone).offset(d3.stackOffsetDiverging);
        const stacked = stack(data);
        stacked.forEach(layer => layer.forEach(d => {
            yMin = Math.min(yMin, d[0], d[1]);
            yMax = Math.max(yMax, d[0], d[1]);
        }));
        const yPad = (yMax - yMin) * 0.08 || 1;
        const y = d3.scaleLinear().domain([yMin - yPad, yMax + yPad]).range([h, 0]);

        g.append('g').attr('class','grid').call(d3.axisLeft(y).tickSize(-w).tickFormat(''));
        g.selectAll('.layer').data(stacked).join('g').attr('class','layer')
            .attr('fill', (d,i) => series[i].color)
            .selectAll('rect').data(d => d).join('rect')
            .attr('x', d => x(d.data.x))
            .attr('y', d => y(Math.max(d[0], d[1])))
            .attr('height', d => Math.abs(y(d[0]) - y(d[1])))
            .attr('width', x.bandwidth());

        // Zero line
        g.append('line').attr('x1',0).attr('x2',w)
            .attr('y1',y(0)).attr('y2',y(0))
            .attr('stroke','#333').attr('stroke-width',0.8);

        g.append('g').attr('class','axis').attr('transform','translate(0,'+h+')')
            .call(d3.axisBottom(x).tickValues(x.domain().filter((d,i) =>
                i % Math.max(1,Math.floor(data.length/8)) === 0)));
        g.append('g').attr('class','axis').call(d3.axisLeft(y).ticks(6));
    } else {
        // Grouped
        data.forEach(d => keys.forEach(k => {
            yMin = Math.min(yMin, d[k]||0);
            yMax = Math.max(yMax, d[k]||0);
        }));
        const yPad = (yMax - yMin) * 0.08 || 1;
        const y = d3.scaleLinear().domain([yMin - yPad, yMax + yPad]).range([h, 0]);
        const x1 = d3.scaleBand().domain(keys).range([0, x.bandwidth()]).padding(0.05);

        g.append('g').attr('class','grid').call(d3.axisLeft(y).tickSize(-w).tickFormat(''));
        g.selectAll('.group').data(data).join('g').attr('class','group')
            .attr('transform', d => 'translate('+x(d.x)+',0)')
            .selectAll('rect').data(d => keys.map(k => ({key:k, val:d[k]||0})))
            .join('rect')
            .attr('x', d => x1(d.key))
            .attr('y', d => y(Math.max(0, d.val)))
            .attr('height', d => Math.abs(y(0) - y(d.val)))
            .attr('width', x1.bandwidth())
            .attr('fill', d => series.find(s=>s.key===d.key).color);

        g.append('line').attr('x1',0).attr('x2',w)
            .attr('y1',y(0)).attr('y2',y(0))
            .attr('stroke','#333').attr('stroke-width',0.8);

        g.append('g').attr('class','axis').attr('transform','translate(0,'+h+')')
            .call(d3.axisBottom(x).tickValues(x.domain().filter((d,i) =>
                i % Math.max(1,Math.floor(data.length/8)) === 0)));
        g.append('g').attr('class','axis').call(d3.axisLeft(y).ticks(6));
    }

    if('Period') g.append('text').attr('x',w/2).attr('y',h+30).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Period');
    if('Contribution') g.append('text').attr('transform','rotate(-90)')
        .attr('x',-h/2).attr('y',-42).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Contribution');

    // Legend
    if(series.length > 1) {
        const leg = g.append('g').attr('class','legend').attr('transform','translate(5,-5)');
        series.forEach((s,i) => {
            const gi = leg.append('g').attr('transform','translate('+(i*90)+',0)');
            gi.append('rect').attr('width',12).attr('height',12).attr('y',-6).attr('fill',s.color);
            gi.append('text').attr('x',16).attr('y',4).attr('font-size','10px').attr('fill','#555').text(s.name);
        });
    }

    // Tooltip
    svg.append('rect').attr('width',W).attr('height',h+margin.top+margin.bottom)
        .attr('fill','none').attr('pointer-events','all')
        .on('mousemove', function(evt) {
            const [mx] = d3.pointer(evt, g.node());
            const bands = x.domain();
            const idx = Math.min(Math.floor(mx / (w / bands.length)), bands.length-1);
            const d = data[Math.max(0,idx)];
            if(!d) return;
            let html = '<b>'+d.x+'</b>';
            series.forEach(s => { if(d[s.key]!==undefined) html += '<br>'+s.name+': '+fmt(d[s.key]); });
            showTip(evt, html);
        })
        .on('mouseout', hideTip);
})();

(function() {
    const data = [{"x":1,"actual":0.006797065473966413,"recon":0.006797065473966413},
{"x":2,"actual":0.007478081537837689,"recon":0.00901433068475471},
{"x":3,"actual":0.003931774012906786,"recon":0.004216755855689971},
{"x":4,"actual":0.01323349510920746,"recon":0.014045030414332053},
{"x":5,"actual":0.004865946043528524,"recon":0.001543578533466356},
{"x":6,"actual":0.005592546578943036,"recon":0.0037199190190702527},
{"x":7,"actual":-0.00019700828905744316,"recon":0.00288469056338465},
{"x":8,"actual":0.004999271340642153,"recon":0.0031694429505465874},
{"x":9,"actual":0.002464822424946611,"recon":-3.236913944785775e-5},
{"x":10,"actual":0.005784379012641949,"recon":0.003134899494555628},
{"x":11,"actual":-0.002018273083187694,"recon":-0.0006031505364887434},
{"x":12,"actual":0.00289692739416747,"recon":0.004606536324513639},
{"x":13,"actual":0.0001469114322585341,"recon":-0.0013750845607099311},
{"x":14,"actual":0.005001679278237248,"recon":0.005079359669604788},
{"x":15,"actual":-0.003129633358873285,"recon":-0.005412674768543306},
{"x":16,"actual":0.0043015363906127035,"recon":0.0010652488077592974},
{"x":17,"actual":0.0024157555877204473,"recon":0.008181923166498305},
{"x":18,"actual":0.00451930917807708,"recon":0.00860587491250176},
{"x":19,"actual":0.0029453491324780146,"recon":0.0010012786075073027},
{"x":20,"actual":-0.004434996841930605,"recon":-0.005218519022761625},
{"x":21,"actual":0.002497608429581355,"recon":-0.0013401285121169837},
{"x":22,"actual":-0.00014968072164389667,"recon":-0.002775916479401762},
{"x":23,"actual":-0.005701295487130054,"recon":-0.004427607562322601},
{"x":24,"actual":-7.60861911217603e-5,"recon":-0.00764263429339549},
{"x":25,"actual":-0.009693959689255571,"recon":-0.011111913363707728},
{"x":26,"actual":0.009750620169152846,"recon":0.006569727416034491},
{"x":27,"actual":-0.003138966589546932,"recon":-0.00015453382667978896},
{"x":28,"actual":-0.0013487581284179484,"recon":-0.008212385348111079},
{"x":29,"actual":0.0033733524412147275,"recon":0.006435557811854066},
{"x":30,"actual":0.005469228290109207,"recon":0.006598282069958751},
{"x":31,"actual":-0.005070632766924987,"recon":-0.006490771996539312},
{"x":32,"actual":0.009040640973159597,"recon":0.0059182521804827136},
{"x":33,"actual":0.004969202991748745,"recon":0.005488863594547106},
{"x":34,"actual":-0.002623250205882499,"recon":-0.0032984878872063302},
{"x":35,"actual":0.0030369033197290562,"recon":0.004448995455913783},
{"x":36,"actual":0.0033858350269504456,"recon":-0.002626329527376797},
{"x":37,"actual":-0.0017488731555337367,"recon":-0.0032340714397059785},
{"x":38,"actual":0.003486749997004601,"recon":0.005873472696134601},
{"x":39,"actual":7.625111401843299e-5,"recon":-0.005799435679047726},
{"x":40,"actual":-0.005859653143676979,"recon":-0.011455649256414551},
{"x":41,"actual":-0.01279714376480623,"recon":-0.011701619549413508},
{"x":42,"actual":-0.007366596588133767,"recon":-0.005437874311400633},
{"x":43,"actual":-0.003261191076563641,"recon":-0.00525069960424183},
{"x":44,"actual":-0.007415936065028106,"recon":-0.01272074372110716},
{"x":45,"actual":-0.005771039266291744,"recon":-0.005839215163814041},
{"x":46,"actual":0.0026351435941132095,"recon":0.0013628013073290585},
{"x":47,"actual":0.009370150601197835,"recon":0.01203605972374952},
{"x":48,"actual":0.008070413249054553,"recon":0.011757669117685214},
{"x":49,"actual":0.0027966918655684125,"recon":0.002599448383761165},
{"x":50,"actual":-1.1339677612909327e-5,"recon":0.0012466085827598158},
{"x":51,"actual":0.007901658951122492,"recon":0.008320593375747982},
{"x":52,"actual":-0.0005466018382946913,"recon":-0.0034648608184109937},
{"x":53,"actual":-0.0015836157055426625,"recon":-0.0037287478788828113},
{"x":54,"actual":-0.004874384309522917,"recon":-0.004964009138584769},
{"x":55,"actual":-0.0052512640267554644,"recon":-0.0028341012277652428},
{"x":56,"actual":0.007034889592290483,"recon":0.0049204261270976},
{"x":57,"actual":0.008489522000498795,"recon":0.009251958668133374},
{"x":58,"actual":0.00756146666679669,"recon":0.007855152550625315},
{"x":59,"actual":0.0032856911647831666,"recon":0.004187528841636881},
{"x":60,"actual":0.0005117224959834132,"recon":-0.0014588769915803174},
{"x":61,"actual":0.009164938072931506,"recon":0.006030027630246043},
{"x":62,"actual":-0.005607554576631202,"recon":-0.00558463291225065},
{"x":63,"actual":0.0032931151719015617,"recon":0.006040106442383722},
{"x":64,"actual":0.00672889068479865,"recon":0.010609717466847132},
{"x":65,"actual":0.0037850447982945568,"recon":0.0007707215218978954},
{"x":66,"actual":0.0016874963663999765,"recon":0.006760737090465112},
{"x":67,"actual":0.003832542487244517,"recon":-0.0037703238338440952},
{"x":68,"actual":0.004804393879324742,"recon":0.0008110041038095197},
{"x":69,"actual":-0.0008739137323683366,"recon":0.0019843076842594627},
{"x":70,"actual":0.0027394050036360085,"recon":0.003875727417142283},
{"x":71,"actual":-0.0037915803418799854,"recon":-0.007616499191069712},
{"x":72,"actual":0.0022526473495334542,"recon":0.002219686937303545},
{"x":73,"actual":0.002693116497312964,"recon":-0.0034421436423832403},
{"x":74,"actual":-0.0012064683528301146,"recon":0.0008819057031344076},
{"x":75,"actual":0.005291488315735116,"recon":0.004473986752897476},
{"x":76,"actual":0.007303652422303131,"recon":0.004651102285104711},
{"x":77,"actual":0.0045590055532489515,"recon":0.003443517396772609},
{"x":78,"actual":0.00590527084702952,"recon":0.0027370578883337358},
{"x":79,"actual":0.0028736794669281807,"recon":0.005146372271738804},
{"x":80,"actual":0.0005827318302769058,"recon":2.7565525322364396e-5},
{"x":81,"actual":0.010149890606631295,"recon":0.00862771419917459},
{"x":82,"actual":0.005896138042652765,"recon":0.0012097106350442539},
{"x":83,"actual":0.004590495958547436,"recon":0.002914412429686113},
{"x":84,"actual":0.006728449687136262,"recon":0.006096309366311184},
{"x":85,"actual":0.0013295056794984106,"recon":0.00196621172802988},
{"x":86,"actual":0.006681857512926825,"recon":0.0033222277263694516},
{"x":87,"actual":0.0031405492615519393,"recon":0.0013526515351286856},
{"x":88,"actual":0.00801293123785829,"recon":0.0079522859719162},
{"x":89,"actual":0.006812622956685388,"recon":0.0064562421963318475},
{"x":90,"actual":0.010166425922232492,"recon":0.007154208397665469},
{"x":91,"actual":0.001700536197938085,"recon":0.004782145914495461},
{"x":92,"actual":-0.0011286873050115886,"recon":-0.004269180390984722},
{"x":93,"actual":0.0016603011582869698,"recon":-0.0006618358401946855},
{"x":94,"actual":-0.0017277257902161836,"recon":-0.0021035782800366025},
{"x":95,"actual":0.004898906985118856,"recon":0.003933658508369195},
{"x":96,"actual":0.0033088514322034968,"recon":-0.010413345617169445},
{"x":97,"actual":-0.00418989274010606,"recon":-0.003128739198895285},
{"x":98,"actual":0.013169322992450994,"recon":0.009977549748634467},
{"x":99,"actual":0.004025176187479218,"recon":0.004505579856474059},
{"x":100,"actual":-0.0017591074109057914,"recon":-0.0025739201990786077},
{"x":101,"actual":0.0026320058946325275,"recon":0.0012956726161358042},
{"x":102,"actual":0.003464824423083712,"recon":0.0012293063821195742},
{"x":103,"actual":-0.005740078791367509,"recon":-0.0039694674719295804},
{"x":104,"actual":0.014529159926465418,"recon":0.015111990564580579},
{"x":105,"actual":-0.0012250426290405514,"recon":-0.0005425982512373183},
{"x":106,"actual":0.009901218260520928,"recon":0.0087731587564337},
{"x":107,"actual":0.0074455836229239125,"recon":0.006384319567476311},
{"x":108,"actual":0.007593378241184112,"recon":0.0018164385668124087},
{"x":109,"actual":0.00015374603570972312,"recon":0.001942087288204328},
{"x":110,"actual":0.0051052352845752935,"recon":0.0025982300398151616},
{"x":111,"actual":0.006239632118214544,"recon":0.0005739964863258761},
{"x":112,"actual":0.00029609405001806977,"recon":0.00498311778986466},
{"x":113,"actual":0.009144785172068737,"recon":0.002378585591655196},
{"x":114,"actual":0.006386648092456149,"recon":0.0044373796545635925},
{"x":115,"actual":0.0015838703738682014,"recon":-0.004324248106525963},
{"x":116,"actual":0.011867816799596476,"recon":0.010319653311971993},
{"x":117,"actual":0.006326080160110159,"recon":0.005664475022936851},
{"x":118,"actual":0.0011715145153683437,"recon":0.002068857570266039},
{"x":119,"actual":0.005524360977567255,"recon":0.003447342426312062},
{"x":120,"actual":0.004585436547763777,"recon":0.004791969635490251},
{"x":121,"actual":0.008505942659710719,"recon":0.010913000369224558},
{"x":122,"actual":0.00995494609358527,"recon":0.009671478408164328},
{"x":123,"actual":0.009117575456573768,"recon":0.006250415883207759},
{"x":124,"actual":0.008827849981996039,"recon":0.011441559710615905},
{"x":125,"actual":0.007844288895028306,"recon":0.003356504009229179},
{"x":126,"actual":0.00424944358291679,"recon":0.0039223171532577475},
{"x":127,"actual":0.004373784275946591,"recon":0.00692158480860481},
{"x":128,"actual":0.0016174896182681309,"recon":-0.0018799338654756949},
{"x":129,"actual":0.0003515910121256738,"recon":0.0007272870716371702},
{"x":130,"actual":0.0034253831806134727,"recon":0.002830921500041838},
{"x":131,"actual":0.0065697125334116535,"recon":0.005223594802706636},
{"x":132,"actual":-0.006016655286145145,"recon":-0.004994170150601098},
{"x":133,"actual":-0.003852986693513749,"recon":-0.00668599230586792},
{"x":134,"actual":0.020491901058277584,"recon":0.016421537236201017},
{"x":135,"actual":-0.0005323279149607174,"recon":-0.0060847257974868795},
{"x":136,"actual":0.006812999094851335,"recon":0.009322629121127872},
{"x":137,"actual":-0.0007584271645324492,"recon":-0.003129549160518291},
{"x":138,"actual":0.004520149593450817,"recon":0.005593967234360156},
{"x":139,"actual":0.0043112451049784895,"recon":0.0024256680660104304},
{"x":140,"actual":0.006063079650347802,"recon":-0.002121973703296044},
{"x":141,"actual":0.0022660526894453525,"recon":0.0015018263171109403},
{"x":142,"actual":0.0022959860915063857,"recon":0.005944469380106057},
{"x":143,"actual":0.006302647258385363,"recon":0.0017972596207937366},
{"x":144,"actual":-0.0007846779120086467,"recon":-0.00019052666405806147},
{"x":145,"actual":0.005769502318011099,"recon":0.00603809635357183},
{"x":146,"actual":0.004007243163624885,"recon":0.0031598194026034978},
{"x":147,"actual":-0.004045261045452442,"recon":-0.002843521404265525},
{"x":148,"actual":0.012148883898799312,"recon":0.00835743641554456},
{"x":149,"actual":0.004835676101424546,"recon":0.0063719862344452025},
{"x":150,"actual":0.007683533835146861,"recon":0.005599654134422621},
{"x":151,"actual":-0.0013689853853140477,"recon":-0.0036660783876773335},
{"x":152,"actual":0.0031184257109906355,"recon":-0.0017589253785520662},
{"x":153,"actual":0.00354941252967933,"recon":0.003834445466578707},
{"x":154,"actual":0.005934581411047191,"recon":0.00604649671960052},
{"x":155,"actual":0.0027040320534066353,"recon":0.0018490323219366705},
{"x":156,"actual":0.00039045672638238216,"recon":8.865723232919821e-5},
{"x":157,"actual":-0.0019527324535886237,"recon":-0.0037176694654617965},
{"x":158,"actual":-0.00272663339275514,"recon":-0.00471066306655338},
{"x":159,"actual":0.004604083024880801,"recon":0.00613329298929333},
{"x":160,"actual":-0.003893384717707171,"recon":-0.012074814872550306},
{"x":161,"actual":0.00027960447484520756,"recon":-0.0009054463286503941},
{"x":162,"actual":-0.0032683707203071677,"recon":-0.004542049532696036},
{"x":163,"actual":-0.004770869350923412,"recon":-0.009002511674269463},
{"x":164,"actual":-0.006534765134370346,"recon":-0.008771214473564817},
{"x":165,"actual":-0.0020524117552422894,"recon":-0.0026059848319146183},
{"x":166,"actual":-0.003596380672338917,"recon":-0.001191851458549882},
{"x":167,"actual":-0.004787344785630587,"recon":-0.0008548969978877862},
{"x":168,"actual":-0.005294243917338015,"recon":-0.008896504700227778},
{"x":169,"actual":-0.006424803271452895,"recon":-0.0020377640768615745},
{"x":170,"actual":-0.0011484395650906976,"recon":-0.003805772670086425},
{"x":171,"actual":-0.005077876004763837,"recon":-0.009219760099917243},
{"x":172,"actual":-0.0027452194543418074,"recon":0.0017713311946589557},
{"x":173,"actual":-0.006065460085318719,"recon":-0.0017856058424787734},
{"x":174,"actual":-0.0004275098074009165,"recon":-0.0035416165224905006},
{"x":175,"actual":0.006633064841170544,"recon":0.00709532329312133},
{"x":176,"actual":0.00011522468260949381,"recon":0.0013856013163992854},
{"x":177,"actual":0.0072123326949231625,"recon":0.009062542356355398},
{"x":178,"actual":0.004871002165678817,"recon":0.001975532692105751},
{"x":179,"actual":0.0040096284673607485,"recon":0.005346738481726054},
{"x":180,"actual":0.008215019236447851,"recon":0.006090679512831941},
{"x":181,"actual":-0.00032197063949990223,"recon":-1.8677533503740247e-5},
{"x":182,"actual":-0.0011111535235635017,"recon":0.0004554449146582599},
{"x":183,"actual":0.0008486486965990636,"recon":0.000992392085320384},
{"x":184,"actual":-0.002084836336934792,"recon":-0.002471014290652988},
{"x":185,"actual":0.0055865759173183704,"recon":0.007057396040742903},
{"x":186,"actual":-0.005576627290919234,"recon":-0.008524415976616219},
{"x":187,"actual":0.00848540572389922,"recon":0.005126083323279181},
{"x":188,"actual":0.0011874209279270076,"recon":-0.0013018456310031172},
{"x":189,"actual":-0.002631971347628159,"recon":-0.005494846859645649},
{"x":190,"actual":-0.005974715309085887,"recon":-0.003805157254193243},
{"x":191,"actual":-0.00027277943080949996,"recon":-3.883163211591779e-5},
{"x":192,"actual":0.0012771147115513415,"recon":-0.0014416521819970553},
{"x":193,"actual":0.005125135550598792,"recon":0.006702111234204931},
{"x":194,"actual":-0.002184157819974608,"recon":0.0006421744133341665},
{"x":195,"actual":0.006426751702139022,"recon":0.0075075378936208925},
{"x":196,"actual":0.0012308567584176089,"recon":-0.0012299873981101322},
{"x":197,"actual":0.006682592049196856,"recon":0.004512839141940239},
{"x":198,"actual":0.0002959460294098548,"recon":-0.002457711852963441},
{"x":199,"actual":0.001520626219034149,"recon":0.004592083696887931},
{"x":200,"actual":0.00601430610916065,"recon":0.002326203195873385},
{"x":201,"actual":-0.004008755848768253,"recon":-0.0026113642011227002},
{"x":202,"actual":0.0037074991758068165,"recon":0.0024419742953074274},
{"x":203,"actual":0.007197750706737338,"recon":0.0016421884969147636},
{"x":204,"actual":-0.007832838806188569,"recon":-0.006844923156408271},
{"x":205,"actual":0.007443879683666665,"recon":0.005370923490155357},
{"x":206,"actual":0.0006709667193680602,"recon":-0.0017921880880804276},
{"x":207,"actual":0.0012701843581544026,"recon":-0.0008844805152551068},
{"x":208,"actual":0.008495312737233363,"recon":0.008383451970876645},
{"x":209,"actual":0.0024803554509942316,"recon":-0.005759888498802523},
{"x":210,"actual":0.007936241000935595,"recon":0.007959546425207109},
{"x":211,"actual":0.0035900791158702816,"recon":0.006439716628039969},
{"x":212,"actual":0.007232846062771081,"recon":0.005948711272514251},
{"x":213,"actual":-0.0013521797796176571,"recon":-0.0007034769001248945},
{"x":214,"actual":0.0021501954438223336,"recon":0.0026923875820667816},
{"x":215,"actual":0.0008997205268519437,"recon":0.000370189390857637},
{"x":216,"actual":0.004487529157463754,"recon":0.004307822333468957},
{"x":217,"actual":-0.003171466288216962,"recon":-0.004670454341618217},
{"x":218,"actual":0.003253788346562203,"recon":0.001759719065138459},
{"x":219,"actual":-0.0195638287695461,"recon":-0.01678360543208392},
{"x":220,"actual":0.012064329407210472,"recon":0.009831871366922974},
{"x":221,"actual":0.01117751662149491,"recon":0.011125692874651635},
{"x":222,"actual":0.005151693564231508,"recon":0.0010799026402678385},
{"x":223,"actual":0.0015766002009156566,"recon":0.0011603495710605987},
{"x":224,"actual":0.0004215001803382634,"recon":-0.0004289644613010425},
{"x":225,"actual":0.002252114659746063,"recon":0.001280940411144107},
{"x":226,"actual":0.0030320784432706915,"recon":-0.00017772165249932978},
{"x":227,"actual":0.0002541145564114444,"recon":-0.0023590803662158844},
{"x":228,"actual":0.0031614092164247154,"recon":0.002715718932812948},
{"x":229,"actual":-0.0005127465055316804,"recon":-0.0027097004972068605},
{"x":230,"actual":0.004379138878333855,"recon":0.0006658883446621004},
{"x":231,"actual":-0.0016629623569395235,"recon":-0.0022574522431684924},
{"x":232,"actual":-0.0011474759561265202,"recon":-0.002403377745554206},
{"x":233,"actual":-0.0004204326283367976,"recon":0.0012034014854977733},
{"x":234,"actual":0.010141747096689357,"recon":0.006476917889204371},
{"x":235,"actual":-0.0033888659943164257,"recon":-0.012255488041240457},
{"x":236,"actual":0.009378469307674386,"recon":0.004997113306383903},
{"x":237,"actual":0.0017786154493029116,"recon":-0.008733189912395044},
{"x":238,"actual":0.006700319901752572,"recon":0.007370877612232688},
{"x":239,"actual":0.0009559214748104949,"recon":-0.0017022425769983932},
{"x":240,"actual":0.0005768477837078123,"recon":-0.0006992938883629944},
{"x":241,"actual":-0.0012002567099926864,"recon":0.00022740168880050916},
{"x":242,"actual":0.0019240393848489745,"recon":-0.0006448640079249244},
{"x":243,"actual":0.002220126784417964,"recon":0.004055782327519738},
{"x":244,"actual":-0.002824061214514728,"recon":-0.001734202946734961},
{"x":245,"actual":0.005320711796714228,"recon":0.006666136846454147},
{"x":246,"actual":0.00034876070631284506,"recon":0.00034400154987401874}];
    const series = [{"name":"Actual","color":"#1f77b4","key":"actual","dash":""},{"name":"Reconstructed","color":"#ff7f0e","key":"recon","dash":"6,3"}];
    const bands = [];
    const refLines = [];

    const container = d3.select('#bhd_line_56');
    const W = Math.max(container.node().clientWidth - 24, 280);
    const margin = {top:10, right:15, bottom:35, left:55};
    const w = W - margin.left - margin.right;
    const h = Math.min(w * 0.6, 250);

    const svg = container.append('svg').attr('width', W).attr('height', h + margin.top + margin.bottom);
    const g = svg.append('g').attr('transform', 'translate('+margin.left+','+margin.top+')');

    // Compute domains
    const xVals = data.map(d => d.x);
    const allYVals = [];
    series.forEach(s => data.forEach(d => { if(d[s.key]!==null) allYVals.push(d[s.key]); }));
    bands.forEach(b => data.forEach(d => {
        if(d[b.lo_key]!==null) allYVals.push(d[b.lo_key]);
        if(d[b.hi_key]!==null) allYVals.push(d[b.hi_key]);
    }));
    refLines.forEach(r => allYVals.push(r.value));

    const x = d3.scaleLinear().domain(d3.extent(xVals)).range([0,w]);
    const yExt = d3.extent(allYVals);
    const yPad = (yExt[1]-yExt[0])*0.08 || 1;
    const y = d3.scaleLinear().domain([yExt[0]-yPad, yExt[1]+yPad]).range([h,0]);

    // Grid
    g.append('g').attr('class','grid').call(d3.axisLeft(y).tickSize(-w).tickFormat(''));

    // Bands
    bands.forEach(b => {
        const area = d3.area()
            .x(d => x(d.x))
            .y0(d => y(d[b.lo_key]!==null ? d[b.lo_key] : 0))
            .y1(d => y(d[b.hi_key]!==null ? d[b.hi_key] : 0))
            .defined(d => d[b.lo_key]!==null && d[b.hi_key]!==null);
        g.append('path').datum(data).attr('d',area)
            .attr('fill',b.color).attr('opacity',b.alpha||0.15);
    });

    // Reference lines
    refLines.forEach(r => {
        g.append('line').attr('x1',0).attr('x2',w)
            .attr('y1',y(r.value)).attr('y2',y(r.value))
            .attr('stroke',r.color||'#999').attr('stroke-width',1)
            .attr('stroke-dasharray',r.dash||'4,3');
    });

    // Lines
    series.forEach(s => {
        const line = d3.line().x(d=>x(d.x)).y(d=>y(d[s.key]))
            .defined(d=>d[s.key]!==null);
        g.append('path').datum(data).attr('d',line)
            .attr('fill','none').attr('stroke',s.color).attr('stroke-width',1.8)
            .attr('stroke-dasharray',s.dash||'');
    });

    // Axes
    g.append('g').attr('class','axis').attr('transform','translate(0,'+h+')')
        .call(d3.axisBottom(x).ticks(Math.min(xVals.length,8)));
    g.append('g').attr('class','axis').call(d3.axisLeft(y).ticks(6));

    if('Period') g.append('text').attr('x',w/2).attr('y',h+30).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Period');
    if('Value') g.append('text').attr('transform','rotate(-90)')
        .attr('x',-h/2).attr('y',-42).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Value');

    // Legend
    if(series.length > 1) {
        const leg = g.append('g').attr('class','legend').attr('transform','translate(5,-5)');
        series.forEach((s,i) => {
            const gi = leg.append('g').attr('transform','translate('+(i*100)+',0)');
            gi.append('line').attr('x1',0).attr('x2',16).attr('y1',0).attr('y2',0)
                .attr('stroke',s.color).attr('stroke-width',2)
                .attr('stroke-dasharray',s.dash||'');
            gi.append('text').attr('x',20).attr('y',4).attr('font-size','10px')
                .attr('fill','#555').text(s.name);
        });
    }

    // Tooltip overlay
    svg.append('rect').attr('width',W).attr('height',h+margin.top+margin.bottom)
        .attr('fill','none').attr('pointer-events','all')
        .on('mousemove', function(evt) {
            const [mx] = d3.pointer(evt, g.node());
            const x0 = x.invert(mx);
            const idx = d3.minIndex(data, d => Math.abs(d.x - x0));
            const d = data[idx];
            let html = '<b>x='+fmt(d.x)+'</b>';
            series.forEach(s => { if(d[s.key]!==null) html += '<br>'+s.name+': '+fmt(d[s.key]); });
            showTip(evt, html);
        })
        .on('mouseout', hideTip);
})();

(function() {
    const data = [{"x":1,"s1":-3.0793204748461595e-5,"s2":-0.03543844628560874,"s3":0.0},
{"x":2,"s1":-0.0014098727584599046,"s2":-0.06487104567239518,"s3":-0.001608145832269152},
{"x":3,"s1":-0.0038161369989505017,"s2":-0.059933059845841796,"s3":-0.0005222402936778969},
{"x":4,"s1":-0.005876985102929555,"s2":0.13912929708789262,"s3":-0.0011730354357620484},
{"x":5,"s1":-0.017276615070957818,"s2":-0.17372826850656678,"s3":-0.005405829925567761},
{"x":6,"s1":-0.016402350844090523,"s2":-0.05699435540444405,"s3":-0.000913066763826747},
{"x":7,"s1":-0.007391390761114248,"s2":0.024128365219875617,"s3":0.002131088797219607},
{"x":8,"s1":-0.008024425594603321,"s2":0.02783611978115664,"s3":-0.0015978277818455532},
{"x":9,"s1":0.0008315986108267677,"s2":0.00636929852950999,"s3":0.003780136118376228},
{"x":10,"s1":0.0014361323013749696,"s2":-0.28381328441740716,"s3":0.001931490976379038},
{"x":11,"s1":0.014228698944778712,"s2":0.20325637084118878,"s3":-0.0016461995107570682},
{"x":12,"s1":0.004118735450783083,"s2":-0.18506476322224244,"s3":-0.0054320440114244755},
{"x":13,"s1":0.012974644661155008,"s2":0.0072683790244711145,"s3":-0.0009903109643725763},
{"x":14,"s1":0.01850823402284551,"s2":0.1986014759892688,"s3":0.000984666442672131},
{"x":15,"s1":0.022071726722722063,"s2":-0.19101230517062848,"s3":-0.0026355265007593142},
{"x":16,"s1":0.01872038479370631,"s2":-0.010197580486036927,"s3":0.005354745691289695},
{"x":17,"s1":0.013283122147831871,"s2":-0.09233144654738673,"s3":-0.0014500870793534891},
{"x":18,"s1":0.0050081306593447224,"s2":0.006072400300513203,"s3":0.0020678789221752476},
{"x":19,"s1":-6.992275394885803e-5,"s2":0.10178162673794994,"s3":0.0011355519586257426},
{"x":20,"s1":-0.0006049020963115699,"s2":-0.19007310255451265,"s3":0.009233697859532583},
{"x":21,"s1":0.013410050631220007,"s2":-0.22033877784080497,"s3":0.01448049832142138},
{"x":22,"s1":0.024174972349339914,"s2":0.18963710631539304,"s3":-0.0018806611923367661},
{"x":23,"s1":0.011505127554722095,"s2":0.0033885824282266176,"s3":0.005942902399566693},
{"x":24,"s1":0.021258971847392102,"s2":0.0793972691876983,"s3":0.01310611314631731},
{"x":25,"s1":0.034788525246041244,"s2":-0.11348201285546154,"s3":0.0042849036823680705},
{"x":26,"s1":0.03825619000636732,"s2":-0.012103848900389779,"s3":-0.002878951136351275},
{"x":27,"s1":0.030502275511665282,"s2":0.08778427053887145,"s3":0.011117179866263465},
{"x":28,"s1":0.011237249185368978,"s2":0.008218585423092208,"s3":0.008024923524292344},
{"x":29,"s1":0.0301880027489807,"s2":0.07566232862780853,"s3":0.003767661803126638},
{"x":30,"s1":0.02496423075006811,"s2":-0.004753079598693318,"s3":0.0016756237078684709},
{"x":31,"s1":0.00032007941260313224,"s2":-9.264693529265414e-5,"s3":0.011561854908995892},
{"x":32,"s1":0.00545655386642997,"s2":-0.10455275336790569,"s3":0.00734874280834264},
{"x":33,"s1":-0.005288299613312088,"s2":-0.09232251564354822,"s3":0.013093231411495723},
{"x":34,"s1":-0.00029046394564701656,"s2":0.19022820827000045,"s3":0.014542011638866651},
{"x":35,"s1":-0.0009392656735712461,"s2":0.0045052263666921005,"s3":0.003490311176537511},
{"x":36,"s1":-0.0037245364582915094,"s2":-0.2092841841387938,"s3":0.01844069467078792},
{"x":37,"s1":-0.0038217752381269248,"s2":0.31139331027431827,"s3":-0.00855103369190914},
{"x":38,"s1":0.010441728271382221,"s2":0.21519658580617823,"s3":0.002986670739246529},
{"x":39,"s1":-0.005764393608101499,"s2":0.2075628284293996,"s3":0.0013064412366506043},
{"x":40,"s1":0.015019564996657266,"s2":-0.0012838917642971326,"s3":-0.00738969421440514},
{"x":41,"s1":0.013419186238159825,"s2":0.2902567501081885,"s3":0.006962126508220825},
{"x":42,"s1":0.03684357476408249,"s2":0.08219162564552529,"s3":-0.013567489666914092},
{"x":43,"s1":0.022079059273565085,"s2":0.0776030643083156,"s3":0.0016319233407454826},
{"x":44,"s1":0.03713228804348992,"s2":0.15841675762412516,"s3":0.012653329853987923},
{"x":45,"s1":0.07127319891515765,"s2":0.15696930157314778,"s3":0.005119477613455898},
{"x":46,"s1":0.05034613796108732,"s2":-0.16188999513603958,"s3":0.02053829003442855},
{"x":47,"s1":0.024111299552096913,"s2":0.1826841045470276,"s3":0.0034808628825335735},
{"x":48,"s1":0.019151857139266572,"s2":8.564497864871812e-5,"s3":0.0037703656543614105},
{"x":49,"s1":-0.011500729401446624,"s2":-0.08408688325271227,"s3":0.00042494670427743937},
{"x":50,"s1":-0.0270591788395564,"s2":0.14012398164263118,"s3":0.0029898806429712915},
{"x":51,"s1":-0.00869676707294283,"s2":0.006460773132852877,"s3":0.00993969718710646},
{"x":52,"s1":-0.001976991015389018,"s2":0.11456732145412334,"s3":0.0064298647725017375},
{"x":53,"s1":-0.014471673709541215,"s2":0.029683339468422033,"s3":-0.003754516082197699},
{"x":54,"s1":-0.005837075482138347,"s2":0.29947668856086235,"s3":0.004140718033935557},
{"x":55,"s1":0.0226806251849859,"s2":-7.211150075464416e-5,"s3":-0.012689586643842475},
{"x":56,"s1":0.0242184646077508,"s2":0.10759703964620747,"s3":-0.014808038112688847},
{"x":57,"s1":0.01396592357557308,"s2":-0.00947270439756509,"s3":0.006170259485929631},
{"x":58,"s1":-0.005528213410232529,"s2":0.019954061365217657,"s3":-0.012205433501771777},
{"x":59,"s1":-0.008859888527882071,"s2":0.2148656434038061,"s3":0.0016649079482172224},
{"x":60,"s1":-0.0023443983128918463,"s2":0.21884120551475028,"s3":-0.009311266420199782},
{"x":61,"s1":0.007271848778602869,"s2":-0.10851216793427992,"s3":0.008933295478428657},
{"x":62,"s1":-0.0067305654244965065,"s2":-0.08230644071129102,"s3":-0.00046186742032897906},
{"x":63,"s1":-0.012429380105103964,"s2":0.03485278202497988,"s3":0.0026119972913665195},
{"x":64,"s1":0.0024806807238096557,"s2":-0.3030428566657458,"s3":-0.006063838781830033},
{"x":65,"s1":-0.008530721861640257,"s2":0.13035906209288123,"s3":-0.0063473908540566245},
{"x":66,"s1":0.002190360915792835,"s2":0.012661665276345928,"s3":-0.004277694061021931},
{"x":67,"s1":0.016327394982243823,"s2":-0.084588539944418,"s3":0.0037817271086530296},
{"x":68,"s1":0.0019931918003443364,"s2":-0.18205228466597045,"s3":-0.01742398304267217},
{"x":69,"s1":-0.002333476521583885,"s2":-0.0759950289238222,"s3":-0.006813266118854723},
{"x":70,"s1":0.015301239381789025,"s2":0.09767218892902886,"s3":-0.011180470944320339},
{"x":71,"s1":0.0020717787848560567,"s2":0.01804324834687627,"s3":-0.0005649794310902802},
{"x":72,"s1":0.0266252467389807,"s2":-0.10868771347916067,"s3":-0.0003123204297131685},
{"x":73,"s1":0.029131668274867212,"s2":-0.09336840923536546,"s3":-0.0033646928036147354},
{"x":74,"s1":0.026477155303578213,"s2":-0.09305380954166768,"s3":-0.0010492016995712237},
{"x":75,"s1":0.002904468102618644,"s2":-0.10265135287114478,"s3":0.004866185740984264},
{"x":76,"s1":0.009118668988878741,"s2":0.09321649170477025,"s3":0.01201263130385001},
{"x":77,"s1":0.008668742949367605,"s2":-0.21011773613700968,"s3":0.00471451511660195},
{"x":78,"s1":0.005153013777160169,"s2":-0.1009582322875876,"s3":0.0023291852062266825},
{"x":79,"s1":-0.0013126351481529928,"s2":0.1130071034776222,"s3":0.021993657698461132},
{"x":80,"s1":-0.004753004606019705,"s2":0.017594026286614647,"s3":0.0033749271344194294},
{"x":81,"s1":0.006882463202248645,"s2":-0.10086861337020764,"s3":0.008292956309015744},
{"x":82,"s1":0.005140848535029836,"s2":-0.07395068408246878,"s3":0.0014317530844928173},
{"x":83,"s1":-0.01285420108046507,"s2":-0.2809505912437136,"s3":0.00661433322856003},
{"x":84,"s1":-0.0031235887221237094,"s2":0.019000360968743024,"s3":-0.0102742068637659},
{"x":85,"s1":-0.0077680840604411605,"s2":0.016782493188751052,"s3":0.0051587851361816275},
{"x":86,"s1":0.014625847626454178,"s2":-0.09481692306029493,"s3":-0.0012229355469731864},
{"x":87,"s1":0.006576153543531317,"s2":-0.09186087727059913,"s3":0.00657485758879621},
{"x":88,"s1":-0.0025791082274539533,"s2":-0.07810653915785776,"s3":-0.004083993111630996},
{"x":89,"s1":0.006992620858107124,"s2":-0.1927161899545476,"s3":-0.020897172483426818},
{"x":90,"s1":-0.0037906286300340205,"s2":-0.07480930027213092,"s3":-0.013968971741050374},
{"x":91,"s1":-0.01590710398574101,"s2":0.1139551582117178,"s3":0.010151055024355324},
{"x":92,"s1":-0.006219569055645193,"s2":-0.20135417227987212,"s3":0.006734669245929254},
{"x":93,"s1":0.003343787382678936,"s2":0.00539023128848058,"s3":-0.010292551063813481},
{"x":94,"s1":0.02349437292821646,"s2":0.39721194109476,"s3":0.0034564788917295607},
{"x":95,"s1":0.016837310354199744,"s2":-0.20584614220766773,"s3":-0.0011439256134645008},
{"x":96,"s1":0.0056297579825355356,"s2":0.010439372065829589,"s3":0.008019336403174706},
{"x":97,"s1":0.008652909584238732,"s2":0.10625483838968824,"s3":0.010150714484080486},
{"x":98,"s1":0.022070040366811736,"s2":0.01775724964406492,"s3":-0.004064254778249497},
{"x":99,"s1":0.0019596174235427524,"s2":-0.10822307561346324,"s3":0.00724198732700874},
{"x":100,"s1":-0.000911952259469579,"s2":-0.09119250542288274,"s3":0.014681779114340363},
{"x":101,"s1":0.014404223187755085,"s2":0.08751726039815151,"s3":0.011013276745241454},
{"x":102,"s1":0.0016084832241217298,"s2":0.011961123980375677,"s3":-0.002538620280450401},
{"x":103,"s1":0.01939913001685928,"s2":-0.02337092291908524,"s3":0.007228327824961675},
{"x":104,"s1":0.015408423673006556,"s2":-0.11543055148479875,"s3":-0.0010516462648999874},
{"x":105,"s1":-0.004917952750454592,"s2":0.020428828212775543,"s3":0.002672080249464802},
{"x":106,"s1":-0.005265617504622117,"s2":0.12407422953827318,"s3":0.0029130177516426556},
{"x":107,"s1":-0.01140801916944897,"s2":0.011515972945760811,"s3":-0.0016372005650658965},
{"x":108,"s1":-0.01725789982271745,"s2":-0.26843481298264416,"s3":-0.0007485168776658379},
{"x":109,"s1":-0.007099833680691711,"s2":0.21173769658081798,"s3":-0.001527669927167452},
{"x":110,"s1":-0.0049394372524391664,"s2":-0.37846368106314354,"s3":0.003198169079570401},
{"x":111,"s1":-0.016066927827041763,"s2":0.11227747131835211,"s3":0.01073393530847289},
{"x":112,"s1":0.006170221299076201,"s2":-0.004468865903065585,"s3":-0.002601790070417871},
{"x":113,"s1":0.011421690464782034,"s2":0.19689418324780728,"s3":0.007364813333381995},
{"x":114,"s1":0.013603943300527693,"s2":-0.004521869345182153,"s3":-0.00583800163176899},
{"x":115,"s1":-0.001633973265210321,"s2":-0.0651300366849798,"s3":-0.005750640779324065},
{"x":116,"s1":-0.0027989860275873827,"s2":-0.09707633506140786,"s3":0.00784947642472009},
{"x":117,"s1":-0.002268342816086872,"s2":0.032185558146005246,"s3":-0.005320693557875435},
{"x":118,"s1":-0.019979385163829792,"s2":-0.08564892183893111,"s3":0.0024129630819574215},
{"x":119,"s1":-0.0069487088048114775,"s2":-0.18854018940322115,"s3":0.005655522920554337},
{"x":120,"s1":0.010908376145018255,"s2":0.11764133184146616,"s3":0.006619840621026645},
{"x":121,"s1":-0.004030000989548463,"s2":-0.09471674635600245,"s3":0.014362294677470234},
{"x":122,"s1":0.001604931846877615,"s2":-0.07709500245140177,"s3":-0.005856891533948628},
{"x":123,"s1":-0.014127284631461158,"s2":0.12825689025727632,"s3":0.008411221086953103},
{"x":124,"s1":-0.022140012107211365,"s2":-0.16653470745221258,"s3":0.008263281982517318},
{"x":125,"s1":-0.02027870545686484,"s2":-0.0605235156112968,"s3":0.000621246648171894},
{"x":126,"s1":-0.02351123705513284,"s2":0.1319944096484015,"s3":-0.007118353586052216},
{"x":127,"s1":-0.007372167629550575,"s2":-0.07183130502069456,"s3":-0.015192102727310756},
{"x":128,"s1":-0.0063001245974704835,"s2":0.022325358007204824,"s3":-0.0031189212572871206},
{"x":129,"s1":0.011962652042770519,"s2":0.11764943242165068,"s3":-0.0024431913842984576},
{"x":130,"s1":0.017325070838546702,"s2":-0.3989952977040795,"s3":-0.006229866940884975},
{"x":131,"s1":0.005124635632347179,"s2":0.11121354063501254,"s3":0.004665932367572301},
{"x":132,"s1":0.014190783954071152,"s2":0.09392734942486561,"s3":-0.0029216083713527246},
{"x":133,"s1":0.00923710793792656,"s2":-0.002060833090776152,"s3":0.009696050473486383},
{"x":134,"s1":0.023964738275765826,"s2":-0.02880402411000911,"s3":-0.012975575261745635},
{"x":135,"s1":0.012793682524650725,"s2":0.1133309533942301,"s3":0.005430199958555908},
{"x":136,"s1":0.003136100562110988,"s2":-0.1004148374399349,"s3":0.00957083023211504},
{"x":137,"s1":-0.007506780746134124,"s2":-0.079994677002839,"s3":-0.0025723656098542566},
{"x":138,"s1":-0.011712169260593187,"s2":0.01795837572654143,"s3":-0.0008413527126809459},
{"x":139,"s1":-0.004163997768302881,"s2":-0.09349176427198852,"s3":0.0037513418460899317},
{"x":140,"s1":-0.003244961436761843,"s2":0.10493458676866627,"s3":0.0035221465710351045},
{"x":141,"s1":-0.0043009452793066495,"s2":-0.20135483641604562,"s3":0.011976579505903216},
{"x":142,"s1":0.017045690914698854,"s2":0.10408313493803573,"s3":-0.01006498479166031},
{"x":143,"s1":0.008874623070820698,"s2":-0.09067341794416353,"s3":-0.004148805817756945},
{"x":144,"s1":0.01404974331304449,"s2":0.10606815842430553,"s3":0.016477381374024047},
{"x":145,"s1":0.009092358060140731,"s2":0.015228807407050224,"s3":-0.0027758236766915073},
{"x":146,"s1":0.010461351925270151,"s2":-0.08335316054037614,"s3":-0.007389564153948638},
{"x":147,"s1":0.02330969169836134,"s2":-0.007349264275278781,"s3":-0.01209563110406823},
{"x":148,"s1":0.002257992060777943,"s2":-0.08977821976505276,"s3":-0.0027909509911560565},
{"x":149,"s1":0.011979572404605447,"s2":0.005431640497664422,"s3":0.0041686087818050615},
{"x":150,"s1":-0.006353079138236974,"s2":-0.08707245939486577,"s3":-0.000672548755666002},
{"x":151,"s1":-0.004701878385892832,"s2":0.009418932341947824,"s3":0.007183026249110014},
{"x":152,"s1":0.005323944939358432,"s2":0.10783481741024764,"s3":0.001263430519609537},
{"x":153,"s1":0.007831498012479671,"s2":-0.09268738070957805,"s3":0.008842590242848253},
{"x":154,"s1":0.0170507022508195,"s2":-0.1848187435500488,"s3":0.003208475416628504},
{"x":155,"s1":-0.007038482095500502,"s2":0.2194603710784318,"s3":0.0030828968784248657},
{"x":156,"s1":0.003135079528680298,"s2":0.013555980568729436,"s3":0.0013169026276097743},
{"x":157,"s1":-0.005943569046150075,"s2":0.011344139479588573,"s3":-0.0022255348639114427},
{"x":158,"s1":0.0290801757587755,"s2":0.09242500469709752,"s3":0.004292088525197859},
{"x":159,"s1":0.028000116224567856,"s2":-0.19812379427974858,"s3":0.00010683695937831683},
{"x":160,"s1":0.008947495513658272,"s2":0.009782871466913461,"s3":-0.005158841861509777},
{"x":161,"s1":0.008901776574175515,"s2":0.007433162487265934,"s3":-0.001462880913380992},
{"x":162,"s1":0.04510198913879024,"s2":-0.02414029553222752,"s3":0.006534573103280835},
{"x":163,"s1":0.023665546468117415,"s2":0.2857788982185341,"s3":-0.005812508484513497},
{"x":164,"s1":0.04602498923290414,"s2":-0.03397388596978257,"s3":0.008163846654135748},
{"x":165,"s1":0.04527129138694076,"s2":0.06914264463697666,"s3":-0.0023620914798365422},
{"x":166,"s1":0.035832795208282156,"s2":0.07722640795648228,"s3":-0.00686243591675921},
{"x":167,"s1":0.031181813704297623,"s2":-0.12001255112246399,"s3":-0.0013380029644845268},
{"x":168,"s1":0.025587007774359308,"s2":0.16539465836587502,"s3":0.013881323374509265},
{"x":169,"s1":0.04082199426511147,"s2":0.08319750330154334,"s3":0.006146397918175633},
{"x":170,"s1":0.048256830660307004,"s2":0.2700048495372611,"s3":-0.00013800853609707275},
{"x":171,"s1":0.03599534460364033,"s2":0.06332173946078519,"s3":0.016510080889630893},
{"x":172,"s1":0.05603021604502573,"s2":0.27860213716730137,"s3":0.0071661209978836},
{"x":173,"s1":0.030919756700040997,"s2":0.17175159134953893,"s3":0.010740212653073792},
{"x":174,"s1":0.034477146410739734,"s2":0.1981042647690669,"s3":-0.018083567589004635},
{"x":175,"s1":0.02361684398685016,"s2":-0.015023289771487508,"s3":0.009654938255939587},
{"x":176,"s1":0.004023739519556405,"s2":-0.012019782565854738,"s3":-0.004180657989103679},
{"x":177,"s1":0.005147185355161573,"s2":0.013000520151813912,"s3":0.0013898391175803217},
{"x":178,"s1":0.01219776875113874,"s2":0.19064162986718128,"s3":0.00041080856773467473},
{"x":179,"s1":-0.0011849208336407223,"s2":-0.11302646285035198,"s3":0.0042553382367667425},
{"x":180,"s1":-0.009222407561300336,"s2":0.00395428951333497,"s3":0.007894716365504074},
{"x":181,"s1":-0.011530193278721615,"s2":0.006431250685091016,"s3":0.0072890320708707676},
{"x":182,"s1":-0.010395331000530984,"s2":-0.07245820676439174,"s3":-0.0013266316704709995},
{"x":183,"s1":0.00034568567781938605,"s2":0.006222005140486266,"s3":-0.004351372712520872},
{"x":184,"s1":0.020986482713384998,"s2":0.015102742797732913,"s3":-0.01860353804979391},
{"x":185,"s1":0.009921449905067372,"s2":0.20902981770297613,"s3":0.0033746273904146913},
{"x":186,"s1":0.011531408370690902,"s2":0.10812649997353818,"s3":-0.008036197153450383},
{"x":187,"s1":0.005361570821322374,"s2":-0.1920305379878414,"s3":-0.01512018050077642},
{"x":188,"s1":0.02095936317705,"s2":0.10207013677209881,"s3":-0.0009738194168787728},
{"x":189,"s1":-0.0004158702996876709,"s2":0.023012187611074687,"s3":0.00535681878347215},
{"x":190,"s1":0.009588158594284416,"s2":0.09989108360900467,"s3":0.0006903160804205737},
{"x":191,"s1":0.023895514515840204,"s2":0.09162416722567124,"s3":-0.014026174972508309},
{"x":192,"s1":0.04514439691293423,"s2":0.16957809809475707,"s3":0.010036142921457693},
{"x":193,"s1":0.041130975440096834,"s2":-0.12212926987178901,"s3":0.003322577279451905},
{"x":194,"s1":0.011425018526100858,"s2":-0.09631619945007786,"s3":-0.0009722596949527264},
{"x":195,"s1":0.007510252172208444,"s2":-0.0006914153545597988,"s3":0.011051967177157949},
{"x":196,"s1":0.00525650860126896,"s2":-0.0966078235323008,"s3":-0.0020509082142695324},
{"x":197,"s1":-0.00590750769559399,"s2":-0.18916104465374356,"s3":0.012330881533188951},
{"x":198,"s1":0.00019116559128088545,"s2":-0.09086817799332589,"s3":0.0024585677750977772},
{"x":199,"s1":0.009607986998914117,"s2":-0.001932088234628097,"s3":0.013288842930173711},
{"x":200,"s1":0.010394455450293794,"s2":-0.09663552328792466,"s3":-0.007727297846809504},
{"x":201,"s1":0.011886628879131063,"s2":0.2072845693592419,"s3":-0.0062163268182529995},
{"x":202,"s1":0.00290878779201436,"s2":-0.1952741321820471,"s3":-0.0040877779224541945},
{"x":203,"s1":0.0320406524909385,"s2":0.013551533249955644,"s3":-0.011313038880145475},
{"x":204,"s1":0.020868643938201946,"s2":0.01308831722846767,"s3":-0.008957268986627905},
{"x":205,"s1":0.016964943070247897,"s2":-0.08185114170301494,"s3":-0.005122889523066452},
{"x":206,"s1":0.03512275013791208,"s2":-0.11291565632692857,"s3":-0.008580343297296133},
{"x":207,"s1":0.005457061767393096,"s2":0.011473712134177309,"s3":-0.0019982457935735993},
{"x":208,"s1":0.04015664587513114,"s2":0.08224321074644289,"s3":0.014220952095625256},
{"x":209,"s1":0.010132912907463779,"s2":-0.10141770732390967,"s3":0.01636122564916137},
{"x":210,"s1":0.006090645584830041,"s2":0.011265679950144332,"s3":-0.00011970357909513152},
{"x":211,"s1":0.013729259600859647,"s2":-0.09232425233822239,"s3":-5.1084530035156405e-5},
{"x":212,"s1":-0.0147341917254813,"s2":0.12849972642368768,"s3":0.002189369944314974},
{"x":213,"s1":-0.013908163551335041,"s2":-0.18740582153126636,"s3":0.01330288821778573},
{"x":214,"s1":0.0047452911700538464,"s2":0.007198390461185732,"s3":-0.005997904581425784},
{"x":215,"s1":0.004343773651882426,"s2":-0.09073381374036499,"s3":0.008221405892341204},
{"x":216,"s1":0.014611691787702333,"s2":-0.09202666059319942,"s3":-0.0061848052308224825},
{"x":217,"s1":0.0010263479554161736,"s2":0.00781410167479163,"s3":0.006100048225145227},
{"x":218,"s1":0.02123731224779894,"s2":-0.094787957827765,"s3":0.001422851794209451},
{"x":219,"s1":0.03428027581374159,"s2":0.07894971110773538,"s3":0.007952121436665996},
{"x":220,"s1":0.0302556825509964,"s2":-0.016803682043386635,"s3":0.012520237893091778},
{"x":221,"s1":0.05386463018787923,"s2":-0.02890209289509872,"s3":-0.005977820858572525},
{"x":222,"s1":-0.010090034956840938,"s2":-0.07663352679954416,"s3":-0.0024430432488496733},
{"x":223,"s1":-0.0027554064292675115,"s2":-0.16634096086275726,"s3":-0.0036318629093928523},
{"x":224,"s1":0.013360201875365737,"s2":0.09229981455649319,"s3":0.01304323596835296},
{"x":225,"s1":0.0022339131969297456,"s2":-0.091611543131343,"s3":0.01585584704885786},
{"x":226,"s1":0.02406378560345644,"s2":0.0026353846607534486,"s3":-0.006763748644411425},
{"x":227,"s1":-0.0002777057409025402,"s2":-0.1034665648547263,"s3":0.025582408593398116},
{"x":228,"s1":0.026023904616698262,"s2":0.001190936223596129,"s3":0.013940069051523719},
{"x":229,"s1":0.0019661990161386265,"s2":0.10583966813182628,"s3":0.0015368039547855664},
{"x":230,"s1":-0.008670517005069062,"s2":0.009584082213113288,"s3":0.007655976482619136},
{"x":231,"s1":0.020936619973527214,"s2":-0.2174010293595128,"s3":0.012811940199538793},
{"x":232,"s1":0.0038767441707445597,"s2":-0.0885997859776272,"s3":0.003104756551637323},
{"x":233,"s1":0.015649939656244408,"s2":0.09768764360839226,"s3":-0.010616048078258177},
{"x":234,"s1":0.018958015150826638,"s2":-0.10851232983765854,"s3":0.007424699414148562},
{"x":235,"s1":-0.0017995361834390496,"s2":0.18843060250324123,"s3":0.025371764771703498},
{"x":236,"s1":0.024249542245061224,"s2":-0.09920348790000198,"s3":-0.004634359229303598},
{"x":237,"s1":0.005722319562826317,"s2":-0.09600356536939302,"s3":0.012146274915219087},
{"x":238,"s1":-0.0010371104712934218,"s2":0.10455789098663525,"s3":0.012764349329865268},
{"x":239,"s1":-0.0020612090450476466,"s2":-0.07595370588760861,"s3":0.005752213315674422},
{"x":240,"s1":-0.007226056794178817,"s2":0.20523345882207444,"s3":0.006116187876720157},
{"x":241,"s1":0.008057518835269287,"s2":0.09860942088018465,"s3":0.017115139776557573},
{"x":242,"s1":0.018707454454358535,"s2":-0.10437362492611504,"s3":-0.0009825557742611556},
{"x":243,"s1":0.02372425663055803,"s2":0.10420607383409587,"s3":0.0020682481203989607},
{"x":244,"s1":0.007472435183855565,"s2":0.016129190356558534,"s3":0.007309351155820491},
{"x":245,"s1":-0.00793611267769768,"s2":-0.019996980135755855,"s3":0.015738784253748472},
{"x":246,"s1":0.031234116081446182,"s2":0.297661938924103,"s3":-0.008873524866614017}];
    const series = [{"name":"INDPRO","color":"#1f77b4","key":"s1","dash":""},{"name":"UNRATE","color":"#ff7f0e","key":"s2","dash":""},{"name":"CPI","color":"#2ca02c","key":"s3","dash":""}];
    const mode = 'stacked';

    const container = d3.select('#bhd_bar_57');
    const W = Math.max(container.node().clientWidth - 24, 280);
    const margin = {top:10, right:15, bottom:35, left:55};
    const w = W - margin.left - margin.right;
    const h = Math.min(w * 0.6, 250);

    const svg = container.append('svg').attr('width', W).attr('height', h + margin.top + margin.bottom);
    const g = svg.append('g').attr('transform', 'translate('+margin.left+','+margin.top+')');

    const keys = series.map(s => s.key);
    const x = d3.scaleBand().domain(data.map(d=>d.x)).range([0,w]).padding(0.15);

    let yMin = 0, yMax = 0;
    if(mode === 'stacked') {
        const stack = d3.stack().keys(keys).order(d3.stackOrderNone).offset(d3.stackOffsetDiverging);
        const stacked = stack(data);
        stacked.forEach(layer => layer.forEach(d => {
            yMin = Math.min(yMin, d[0], d[1]);
            yMax = Math.max(yMax, d[0], d[1]);
        }));
        const yPad = (yMax - yMin) * 0.08 || 1;
        const y = d3.scaleLinear().domain([yMin - yPad, yMax + yPad]).range([h, 0]);

        g.append('g').attr('class','grid').call(d3.axisLeft(y).tickSize(-w).tickFormat(''));
        g.selectAll('.layer').data(stacked).join('g').attr('class','layer')
            .attr('fill', (d,i) => series[i].color)
            .selectAll('rect').data(d => d).join('rect')
            .attr('x', d => x(d.data.x))
            .attr('y', d => y(Math.max(d[0], d[1])))
            .attr('height', d => Math.abs(y(d[0]) - y(d[1])))
            .attr('width', x.bandwidth());

        // Zero line
        g.append('line').attr('x1',0).attr('x2',w)
            .attr('y1',y(0)).attr('y2',y(0))
            .attr('stroke','#333').attr('stroke-width',0.8);

        g.append('g').attr('class','axis').attr('transform','translate(0,'+h+')')
            .call(d3.axisBottom(x).tickValues(x.domain().filter((d,i) =>
                i % Math.max(1,Math.floor(data.length/8)) === 0)));
        g.append('g').attr('class','axis').call(d3.axisLeft(y).ticks(6));
    } else {
        // Grouped
        data.forEach(d => keys.forEach(k => {
            yMin = Math.min(yMin, d[k]||0);
            yMax = Math.max(yMax, d[k]||0);
        }));
        const yPad = (yMax - yMin) * 0.08 || 1;
        const y = d3.scaleLinear().domain([yMin - yPad, yMax + yPad]).range([h, 0]);
        const x1 = d3.scaleBand().domain(keys).range([0, x.bandwidth()]).padding(0.05);

        g.append('g').attr('class','grid').call(d3.axisLeft(y).tickSize(-w).tickFormat(''));
        g.selectAll('.group').data(data).join('g').attr('class','group')
            .attr('transform', d => 'translate('+x(d.x)+',0)')
            .selectAll('rect').data(d => keys.map(k => ({key:k, val:d[k]||0})))
            .join('rect')
            .attr('x', d => x1(d.key))
            .attr('y', d => y(Math.max(0, d.val)))
            .attr('height', d => Math.abs(y(0) - y(d.val)))
            .attr('width', x1.bandwidth())
            .attr('fill', d => series.find(s=>s.key===d.key).color);

        g.append('line').attr('x1',0).attr('x2',w)
            .attr('y1',y(0)).attr('y2',y(0))
            .attr('stroke','#333').attr('stroke-width',0.8);

        g.append('g').attr('class','axis').attr('transform','translate(0,'+h+')')
            .call(d3.axisBottom(x).tickValues(x.domain().filter((d,i) =>
                i % Math.max(1,Math.floor(data.length/8)) === 0)));
        g.append('g').attr('class','axis').call(d3.axisLeft(y).ticks(6));
    }

    if('Period') g.append('text').attr('x',w/2).attr('y',h+30).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Period');
    if('Contribution') g.append('text').attr('transform','rotate(-90)')
        .attr('x',-h/2).attr('y',-42).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Contribution');

    // Legend
    if(series.length > 1) {
        const leg = g.append('g').attr('class','legend').attr('transform','translate(5,-5)');
        series.forEach((s,i) => {
            const gi = leg.append('g').attr('transform','translate('+(i*90)+',0)');
            gi.append('rect').attr('width',12).attr('height',12).attr('y',-6).attr('fill',s.color);
            gi.append('text').attr('x',16).attr('y',4).attr('font-size','10px').attr('fill','#555').text(s.name);
        });
    }

    // Tooltip
    svg.append('rect').attr('width',W).attr('height',h+margin.top+margin.bottom)
        .attr('fill','none').attr('pointer-events','all')
        .on('mousemove', function(evt) {
            const [mx] = d3.pointer(evt, g.node());
            const bands = x.domain();
            const idx = Math.min(Math.floor(mx / (w / bands.length)), bands.length-1);
            const d = data[Math.max(0,idx)];
            if(!d) return;
            let html = '<b>'+d.x+'</b>';
            series.forEach(s => { if(d[s.key]!==undefined) html += '<br>'+s.name+': '+fmt(d[s.key]); });
            showTip(evt, html);
        })
        .on('mouseout', hideTip);
})();

(function() {
    const data = [{"x":1,"actual":-0.10000000000000053,"recon":-0.1009144260309088},
{"x":2,"actual":-0.09999999999999964,"recon":-0.1039876383922668},
{"x":3,"actual":-0.09999999999999964,"recon":-0.09875557903126542},
{"x":4,"actual":0.09999999999999964,"recon":0.10157354753531271},
{"x":5,"actual":-0.20000000000000018,"recon":-0.20262164787397058},
{"x":6,"actual":-0.09999999999999964,"recon":-0.08533418308588442},
{"x":7,"actual":0.0,"recon":0.009190127521938936},
{"x":8,"actual":0.0,"recon":0.01336287742165903},
{"x":9,"actual":0.0,"recon":0.004643274399401285},
{"x":10,"actual":-0.2999999999999998,"recon":-0.28895474877830174},
{"x":11,"actual":0.1999999999999993,"recon":0.2025447385425731},
{"x":12,"actual":-0.1999999999999993,"recon":-0.19042615242950794},
{"x":13,"actual":0.0,"recon":0.00519706793345988},
{"x":14,"actual":0.1999999999999993,"recon":0.20424499545913247},
{"x":15,"actual":-0.1999999999999993,"recon":-0.17784999403850987},
{"x":16,"actual":0.0,"recon":0.006030274281072249},
{"x":17,"actual":-0.10000000000000053,"recon":-0.08141739787407053},
{"x":18,"actual":0.0,"recon":0.007435069335287159},
{"x":19,"actual":0.10000000000000053,"recon":0.09834893720286941},
{"x":20,"actual":-0.20000000000000018,"recon":-0.19128183684504724},
{"x":21,"actual":-0.20000000000000018,"recon":-0.20292032576750685},
{"x":22,"actual":0.20000000000000018,"recon":0.2047544819487172},
{"x":23,"actual":0.0,"recon":0.007216461050004824},
{"x":24,"actual":0.09999999999999964,"recon":0.09936992422225534},
{"x":25,"actual":-0.09999999999999964,"recon":-0.0847156664137384},
{"x":26,"actual":0.0,"recon":0.008843777622972763},
{"x":27,"actual":0.09999999999999964,"recon":0.11698724116631909},
{"x":28,"actual":0.0,"recon":0.016687749347780525},
{"x":29,"actual":0.10000000000000053,"recon":0.1023408097984736},
{"x":30,"actual":0.0,"recon":0.010917852371615386},
{"x":31,"actual":0.0,"recon":0.0057907953958863875},
{"x":32,"actual":-0.10000000000000053,"recon":-0.09642338457004726},
{"x":33,"actual":-0.09999999999999964,"recon":-0.08907102800166261},
{"x":34,"actual":0.20000000000000018,"recon":0.1957157196999289},
{"x":35,"actual":0.0,"recon":0.001101469492834144},
{"x":36,"actual":-0.20000000000000018,"recon":-0.2003705008926163},
{"x":37,"actual":0.2999999999999998,"recon":0.2939095738439025},
{"x":38,"actual":0.20000000000000018,"recon":0.2229363620380277},
{"x":39,"actual":0.20000000000000018,"recon":0.19494404184505865},
{"x":40,"actual":0.0,"recon":-0.0009560645398160109},
{"x":41,"actual":0.2999999999999998,"recon":0.3023284119731474},
{"x":42,"actual":0.09999999999999964,"recon":0.09582179954148892},
{"x":43,"actual":0.10000000000000053,"recon":0.09370588745787331},
{"x":44,"actual":0.1999999999999993,"recon":0.19822470764566635},
{"x":45,"actual":0.20000000000000018,"recon":0.22564868679472178},
{"x":46,"actual":-0.09999999999999964,"recon":-0.09888526566180666},
{"x":47,"actual":0.20000000000000018,"recon":0.2001183349390383},
{"x":48,"actual":0.0,"recon":0.014097507842168133},
{"x":49,"actual":-0.10000000000000053,"recon":-0.10626696522678339},
{"x":50,"actual":0.10000000000000053,"recon":0.10939267867070569},
{"x":51,"actual":0.0,"recon":0.0012955355256916044},
{"x":52,"actual":0.09999999999999964,"recon":0.11056565801383147},
{"x":53,"actual":0.0,"recon":0.004246767460500994},
{"x":54,"actual":0.2999999999999998,"recon":0.2904163521305193},
{"x":55,"actual":0.0,"recon":0.0025284226646810426},
{"x":56,"actual":0.10000000000000053,"recon":0.10929194930047016},
{"x":57,"actual":0.0,"recon":0.0030878915639295165},
{"x":58,"actual":0.0,"recon":-0.005839998482994687},
{"x":59,"actual":0.1999999999999993,"recon":0.1992850587802663},
{"x":60,"actual":0.20000000000000018,"recon":0.19949729640609454},
{"x":61,"actual":-0.09999999999999964,"recon":-0.09973795031759061},
{"x":62,"actual":-0.10000000000000053,"recon":-0.09934253955722447},
{"x":63,"actual":0.0,"recon":0.016069455282196412},
{"x":64,"actual":-0.2999999999999998,"recon":-0.31334268084828465},
{"x":65,"actual":0.10000000000000053,"recon":0.10691725543727751},
{"x":66,"actual":0.0,"recon":0.0021291900867477266},
{"x":67,"actual":-0.10000000000000053,"recon":-0.07257131329458402},
{"x":68,"actual":-0.20000000000000018,"recon":-0.20433191957348026},
{"x":69,"actual":-0.09999999999999964,"recon":-0.0922446556824042},
{"x":70,"actual":0.09999999999999964,"recon":0.09354578006224572},
{"x":71,"actual":0.0,"recon":0.012926124026876424},
{"x":72,"actual":-0.09999999999999964,"recon":-0.09180375308437669},
{"x":73,"actual":-0.09999999999999964,"recon":-0.07624189189869655},
{"x":74,"actual":-0.10000000000000053,"recon":-0.07213287841978042},
{"x":75,"actual":-0.09999999999999964,"recon":-0.10070338598537876},
{"x":76,"actual":0.09999999999999964,"recon":0.10732818014977391},
{"x":77,"actual":-0.20000000000000018,"recon":-0.20308472845283976},
{"x":78,"actual":-0.09999999999999964,"recon":-0.09821120004172212},
{"x":79,"actual":0.09999999999999964,"recon":0.12793227985504385},
{"x":80,"actual":0.0,"recon":0.0081682712125958},
{"x":81,"actual":-0.09999999999999964,"recon":-0.09207359433380652},
{"x":82,"actual":-0.09999999999999964,"recon":-0.07487250849199409},
{"x":83,"actual":-0.3000000000000007,"recon":-0.2991213511815383},
{"x":84,"actual":0.0,"recon":-0.0026658462904188968},
{"x":85,"actual":0.0,"recon":0.004893214696857984},
{"x":86,"actual":-0.09999999999999964,"recon":-0.09086535824620756},
{"x":87,"actual":-0.09999999999999964,"recon":-0.08616859907291147},
{"x":88,"actual":-0.10000000000000053,"recon":-0.09052645867401046},
{"x":89,"actual":-0.20000000000000018,"recon":-0.21319977639583054},
{"x":90,"actual":-0.09999999999999964,"recon":-0.09879488059508966},
{"x":91,"actual":0.09999999999999964,"recon":0.10201682987084634},
{"x":92,"actual":-0.1999999999999993,"recon":-0.20638998266869685},
{"x":93,"actual":0.0,"recon":-0.008105094778413997},
{"x":94,"actual":0.39999999999999947,"recon":0.417747476542851},
{"x":95,"actual":-0.20000000000000018,"recon":-0.19755565661704533},
{"x":96,"actual":0.0,"recon":0.015063172799003193},
{"x":97,"actual":0.10000000000000053,"recon":0.11731709829288925},
{"x":98,"actual":0.0,"recon":0.027999937715479116},
{"x":99,"actual":-0.10000000000000053,"recon":-0.1077204186904453},
{"x":100,"actual":-0.09999999999999964,"recon":-0.08488646334615399},
{"x":101,"actual":0.09999999999999964,"recon":0.1048777631313442},
{"x":102,"actual":0.0,"recon":0.004559852956088675},
{"x":103,"actual":0.0,"recon":-0.004614114239614315},
{"x":104,"actual":-0.09999999999999964,"recon":-0.10839368304264435},
{"x":105,"actual":0.0,"recon":0.01152037182834737},
{"x":106,"actual":0.09999999999999964,"recon":0.11474970098654871},
{"x":107,"actual":0.0,"recon":-0.007233118683907237},
{"x":108,"actual":-0.2999999999999998,"recon":-0.2939575876808211},
{"x":109,"actual":0.20000000000000018,"recon":0.1954923591644871},
{"x":110,"actual":-0.40000000000000036,"recon":-0.38777229722599316},
{"x":111,"actual":0.10000000000000053,"recon":0.09838991207575006},
{"x":112,"actual":0.0,"recon":-0.008022394295374859},
{"x":113,"actual":0.20000000000000018,"recon":0.20877186538013817},
{"x":114,"actual":0.0,"recon":-0.003562340873443008},
{"x":115,"actual":-0.10000000000000053,"recon":-0.07907128028598648},
{"x":116,"actual":-0.09999999999999964,"recon":-0.09755486821102985},
{"x":117,"actual":0.0,"recon":0.01784492640219052},
{"x":118,"actual":-0.10000000000000053,"recon":-0.11102206077915441},
{"x":119,"actual":-0.1999999999999993,"recon":-0.19703260303241643},
{"x":120,"actual":0.09999999999999964,"recon":0.12788238367099258},
{"x":121,"actual":-0.09999999999999964,"recon":-0.09282407761598045},
{"x":122,"actual":-0.10000000000000053,"recon":-0.08977786492623888},
{"x":123,"actual":0.10000000000000053,"recon":0.11546021673645573},
{"x":124,"actual":-0.20000000000000018,"recon":-0.1894864888100527},
{"x":125,"actual":-0.10000000000000053,"recon":-0.0880969459088418},
{"x":126,"actual":0.10000000000000053,"recon":0.094594407614956},
{"x":127,"actual":-0.10000000000000053,"recon":-0.101882107672643},
{"x":128,"actual":0.0,"recon":0.006188918057449681},
{"x":129,"actual":0.10000000000000053,"recon":0.1203473411065776},
{"x":130,"actual":-0.40000000000000036,"recon":-0.3943219244433169},
{"x":131,"actual":0.10000000000000053,"recon":0.11386155036012044},
{"x":132,"actual":0.09999999999999964,"recon":0.09792340983445183},
{"x":133,"actual":0.0,"recon":0.011605275503802786},
{"x":134,"actual":0.0,"recon":-0.025138372907816675},
{"x":135,"actual":0.09999999999999964,"recon":0.12431645447459455},
{"x":136,"actual":-0.09999999999999964,"recon":-0.09481590886928566},
{"x":137,"actual":-0.09999999999999964,"recon":-0.09704205093579382},
{"x":138,"actual":0.0,"recon":-0.002808955842037334},
{"x":139,"actual":-0.10000000000000053,"recon":-0.10243625848486976},
{"x":140,"actual":0.10000000000000053,"recon":0.09777209103285867},
{"x":141,"actual":-0.20000000000000018,"recon":-0.2015931616584435},
{"x":142,"actual":0.09999999999999964,"recon":0.10294497842461112},
{"x":143,"actual":-0.09999999999999964,"recon":-0.09305273106141973},
{"x":144,"actual":0.09999999999999964,"recon":0.12953275063195632},
{"x":145,"actual":0.0,"recon":0.01429186843861479},
{"x":146,"actual":-0.09999999999999964,"recon":-0.08631944759693916},
{"x":147,"actual":0.0,"recon":-0.002803135930632722},
{"x":148,"actual":-0.10000000000000053,"recon":-0.09740991933035392},
{"x":149,"actual":0.0,"recon":0.014581981570182038},
{"x":150,"actual":-0.09999999999999964,"recon":-0.10101248775436249},
{"x":151,"actual":0.0,"recon":0.005031119282172862},
{"x":152,"actual":0.09999999999999964,"recon":0.10755097562175589},
{"x":153,"actual":-0.09999999999999964,"recon":-0.08308511153941116},
{"x":154,"actual":-0.20000000000000018,"recon":-0.17150218692791078},
{"x":155,"actual":0.20000000000000018,"recon":0.2075989806045426},
{"x":156,"actual":0.0,"recon":0.010855119878633197},
{"x":157,"actual":0.0,"recon":-0.004374254685823012},
{"x":158,"actual":0.09999999999999964,"recon":0.11787279700997996},
{"x":159,"actual":-0.19999999999999973,"recon":-0.17717115861607233},
{"x":160,"actual":0.0,"recon":0.005381808900682709},
{"x":161,"actual":0.0,"recon":0.007697074449559453},
{"x":162,"actual":0.0,"recon":0.020540914347733166},
{"x":163,"actual":0.30000000000000027,"recon":0.29671191836135713},
{"x":164,"actual":0.0,"recon":0.013296243701208521},
{"x":165,"actual":0.09999999999999964,"recon":0.10510190101930961},
{"x":166,"actual":0.10000000000000053,"recon":0.09919281169927399},
{"x":167,"actual":-0.10000000000000053,"recon":-0.09723435732801415},
{"x":168,"actual":0.20000000000000018,"recon":0.1977443663037937},
{"x":169,"actual":0.09999999999999964,"recon":0.12338289939994262},
{"x":170,"actual":0.3000000000000007,"recon":0.31097152916934057},
{"x":171,"actual":0.09999999999999964,"recon":0.10870046795048316},
{"x":172,"actual":0.2999999999999998,"recon":0.33493661541723563},
{"x":173,"actual":0.20000000000000018,"recon":0.2063823543534571},
{"x":174,"actual":0.20000000000000018,"recon":0.2066301877034098},
{"x":175,"actual":0.0,"recon":0.010791685193586482},
{"x":176,"actual":0.0,"recon":-0.020212879078244202},
{"x":177,"actual":0.0,"recon":0.011590969898727602},
{"x":178,"actual":0.20000000000000018,"recon":0.19579633347169884},
{"x":179,"actual":-0.10000000000000053,"recon":-0.1180488955773702},
{"x":180,"actual":0.0,"recon":-0.004468418007712567},
{"x":181,"actual":0.0,"recon":-0.0049288832498454406},
{"x":182,"actual":-0.09999999999999964,"recon":-0.09111913190907443},
{"x":183,"actual":0.0,"recon":-0.004889494802936402},
{"x":184,"actual":0.0,"recon":0.010411434456060627},
{"x":185,"actual":0.20000000000000018,"recon":0.2152891269389019},
{"x":186,"actual":0.09999999999999964,"recon":0.10461836787272696},
{"x":187,"actual":-0.20000000000000018,"recon":-0.20877152897511786},
{"x":188,"actual":0.10000000000000053,"recon":0.11507706135079766},
{"x":189,"actual":0.0,"recon":0.02096103053029187},
{"x":190,"actual":0.09999999999999964,"recon":0.10315111717957626},
{"x":191,"actual":0.09999999999999964,"recon":0.09444335584236965},
{"x":192,"actual":0.20000000000000018,"recon":0.21767986310633408},
{"x":193,"actual":-0.09999999999999964,"recon":-0.0855234766170385},
{"x":194,"actual":-0.10000000000000053,"recon":-0.09403370312661843},
{"x":195,"actual":0.0,"recon":0.010468329801550007},
{"x":196,"actual":-0.09999999999999964,"recon":-0.10140192903160072},
{"x":197,"actual":-0.20000000000000018,"recon":-0.1908148054999671},
{"x":198,"actual":-0.09999999999999964,"recon":-0.0957057866265551},
{"x":199,"actual":0.0,"recon":0.01396392990391948},
{"x":200,"actual":-0.10000000000000053,"recon":-0.10096536252600728},
{"x":201,"actual":0.20000000000000018,"recon":0.2059491743236594},
{"x":202,"actual":-0.20000000000000018,"recon":-0.2034771224862267},
{"x":203,"actual":0.0,"recon":0.02723247292703452},
{"x":204,"actual":0.0,"recon":0.01793205255695138},
{"x":205,"actual":-0.09999999999999964,"recon":-0.07709067196414332},
{"x":206,"actual":-0.09999999999999964,"recon":-0.09345853622242153},
{"x":207,"actual":0.0,"recon":0.007854187776097869},
{"x":208,"actual":0.09999999999999964,"recon":0.1295577052794233},
{"x":209,"actual":-0.09999999999999964,"recon":-0.08196751516450673},
{"x":210,"actual":0.0,"recon":0.010210604576207196},
{"x":211,"actual":-0.10000000000000053,"recon":-0.08565995095685118},
{"x":212,"actual":0.10000000000000053,"recon":0.10844905260087548},
{"x":213,"actual":-0.20000000000000018,"recon":-0.1958689962194642},
{"x":214,"actual":0.0,"recon":-0.002133645419857357},
{"x":215,"actual":-0.10000000000000053,"recon":-0.08624835408957174},
{"x":216,"actual":-0.09999999999999964,"recon":-0.09124499964623109},
{"x":217,"actual":0.0,"recon":0.007869897726950898},
{"x":218,"actual":-0.09999999999999964,"recon":-0.07920172494220569},
{"x":219,"actual":0.09999999999999964,"recon":0.11411254834562305},
{"x":220,"actual":0.0,"recon":0.018913213630633308},
{"x":221,"actual":0.0,"recon":0.011939345957771737},
{"x":222,"actual":-0.09999999999999964,"recon":-0.09619888880813958},
{"x":223,"actual":-0.20000000000000018,"recon":-0.17975133863718487},
{"x":224,"actual":0.09999999999999964,"recon":0.11168325106171453},
{"x":225,"actual":-0.09999999999999964,"recon":-0.08054522276267076},
{"x":226,"actual":0.0,"recon":0.01290323338628099},
{"x":227,"actual":-0.10000000000000053,"recon":-0.08520556939505612},
{"x":228,"actual":0.0,"recon":0.0341000304950179},
{"x":229,"actual":0.10000000000000053,"recon":0.10227982882402462},
{"x":230,"actual":0.0,"recon":0.0015038273344598774},
{"x":231,"actual":-0.20000000000000018,"recon":-0.1908836534366002},
{"x":232,"actual":-0.09999999999999964,"recon":-0.08938462578728373},
{"x":233,"actual":0.09999999999999964,"recon":0.09487905308616698},
{"x":234,"actual":-0.09999999999999964,"recon":-0.0895878016361634},
{"x":235,"actual":0.1999999999999993,"recon":0.2049732087992185},
{"x":236,"actual":-0.09999999999999964,"recon":-0.08661529094521164},
{"x":237,"actual":-0.09999999999999964,"recon":-0.0851640402821717},
{"x":238,"actual":0.09999999999999964,"recon":0.10925004654301845},
{"x":239,"actual":-0.09999999999999964,"recon":-0.07930596912172214},
{"x":240,"actual":0.1999999999999993,"recon":0.1970721938447146},
{"x":241,"actual":0.10000000000000053,"recon":0.11672470333622736},
{"x":242,"actual":-0.10000000000000053,"recon":-0.09370850687275004},
{"x":243,"actual":0.10000000000000053,"recon":0.12294039817502544},
{"x":244,"actual":0.0,"recon":0.023857774819710187},
{"x":245,"actual":0.0,"recon":-0.019240617520338246},
{"x":246,"actual":0.2999999999999998,"recon":0.3129831491457006}];
    const series = [{"name":"Actual","color":"#1f77b4","key":"actual","dash":""},{"name":"Reconstructed","color":"#ff7f0e","key":"recon","dash":"6,3"}];
    const bands = [];
    const refLines = [];

    const container = d3.select('#bhd_line_58');
    const W = Math.max(container.node().clientWidth - 24, 280);
    const margin = {top:10, right:15, bottom:35, left:55};
    const w = W - margin.left - margin.right;
    const h = Math.min(w * 0.6, 250);

    const svg = container.append('svg').attr('width', W).attr('height', h + margin.top + margin.bottom);
    const g = svg.append('g').attr('transform', 'translate('+margin.left+','+margin.top+')');

    // Compute domains
    const xVals = data.map(d => d.x);
    const allYVals = [];
    series.forEach(s => data.forEach(d => { if(d[s.key]!==null) allYVals.push(d[s.key]); }));
    bands.forEach(b => data.forEach(d => {
        if(d[b.lo_key]!==null) allYVals.push(d[b.lo_key]);
        if(d[b.hi_key]!==null) allYVals.push(d[b.hi_key]);
    }));
    refLines.forEach(r => allYVals.push(r.value));

    const x = d3.scaleLinear().domain(d3.extent(xVals)).range([0,w]);
    const yExt = d3.extent(allYVals);
    const yPad = (yExt[1]-yExt[0])*0.08 || 1;
    const y = d3.scaleLinear().domain([yExt[0]-yPad, yExt[1]+yPad]).range([h,0]);

    // Grid
    g.append('g').attr('class','grid').call(d3.axisLeft(y).tickSize(-w).tickFormat(''));

    // Bands
    bands.forEach(b => {
        const area = d3.area()
            .x(d => x(d.x))
            .y0(d => y(d[b.lo_key]!==null ? d[b.lo_key] : 0))
            .y1(d => y(d[b.hi_key]!==null ? d[b.hi_key] : 0))
            .defined(d => d[b.lo_key]!==null && d[b.hi_key]!==null);
        g.append('path').datum(data).attr('d',area)
            .attr('fill',b.color).attr('opacity',b.alpha||0.15);
    });

    // Reference lines
    refLines.forEach(r => {
        g.append('line').attr('x1',0).attr('x2',w)
            .attr('y1',y(r.value)).attr('y2',y(r.value))
            .attr('stroke',r.color||'#999').attr('stroke-width',1)
            .attr('stroke-dasharray',r.dash||'4,3');
    });

    // Lines
    series.forEach(s => {
        const line = d3.line().x(d=>x(d.x)).y(d=>y(d[s.key]))
            .defined(d=>d[s.key]!==null);
        g.append('path').datum(data).attr('d',line)
            .attr('fill','none').attr('stroke',s.color).attr('stroke-width',1.8)
            .attr('stroke-dasharray',s.dash||'');
    });

    // Axes
    g.append('g').attr('class','axis').attr('transform','translate(0,'+h+')')
        .call(d3.axisBottom(x).ticks(Math.min(xVals.length,8)));
    g.append('g').attr('class','axis').call(d3.axisLeft(y).ticks(6));

    if('Period') g.append('text').attr('x',w/2).attr('y',h+30).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Period');
    if('Value') g.append('text').attr('transform','rotate(-90)')
        .attr('x',-h/2).attr('y',-42).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Value');

    // Legend
    if(series.length > 1) {
        const leg = g.append('g').attr('class','legend').attr('transform','translate(5,-5)');
        series.forEach((s,i) => {
            const gi = leg.append('g').attr('transform','translate('+(i*100)+',0)');
            gi.append('line').attr('x1',0).attr('x2',16).attr('y1',0).attr('y2',0)
                .attr('stroke',s.color).attr('stroke-width',2)
                .attr('stroke-dasharray',s.dash||'');
            gi.append('text').attr('x',20).attr('y',4).attr('font-size','10px')
                .attr('fill','#555').text(s.name);
        });
    }

    // Tooltip overlay
    svg.append('rect').attr('width',W).attr('height',h+margin.top+margin.bottom)
        .attr('fill','none').attr('pointer-events','all')
        .on('mousemove', function(evt) {
            const [mx] = d3.pointer(evt, g.node());
            const x0 = x.invert(mx);
            const idx = d3.minIndex(data, d => Math.abs(d.x - x0));
            const d = data[idx];
            let html = '<b>x='+fmt(d.x)+'</b>';
            series.forEach(s => { if(d[s.key]!==null) html += '<br>'+s.name+': '+fmt(d[s.key]); });
            showTip(evt, html);
        })
        .on('mouseout', hideTip);
})();

(function() {
    const data = [{"x":1,"s1":-2.3252310343625622e-5,"s2":5.449794655958133e-5,"s3":-0.004471979645599541},
{"x":2,"s1":-0.00012498471516527506,"s2":0.00013139402385769307,"s3":0.005521245453243626},
{"x":3,"s1":-0.0005586007541835043,"s2":3.0705593260728505e-5,"s3":-0.0023358523954692015},
{"x":4,"s1":-0.0009429388126575173,"s2":-0.0008430388938834598,"s3":0.0012548587057936383},
{"x":5,"s1":0.0008304461685335957,"s2":-0.0004479609322068845,"s3":-0.0009881363280916445},
{"x":6,"s1":-0.00015427685005360038,"s2":-0.0025468935830428702,"s3":0.002371824864570612},
{"x":7,"s1":-0.00091242171300986,"s2":0.001820069674377367,"s3":0.0019487547636649837},
{"x":8,"s1":-0.002516766521430863,"s2":-0.001688853384999384,"s3":0.0021441015214474163},
{"x":9,"s1":0.0023112150656286615,"s2":-0.004789053938313165,"s3":0.0014456765213737947},
{"x":10,"s1":-0.0024323068791135562,"s2":0.002802842991926871,"s3":0.0029384717894028805},
{"x":11,"s1":0.0011847955920931265,"s2":-0.0007208312785621766,"s3":-0.003371580234895347},
{"x":12,"s1":-0.0010299336610234242,"s2":0.0005159113720585689,"s3":0.0008091828182935353},
{"x":13,"s1":-0.0002976022931005835,"s2":-0.0041671312740547495,"s3":0.0001231851744894988},
{"x":14,"s1":5.9544781044981875e-5,"s2":-0.0007678144164245107,"s3":3.571532333790763e-5},
{"x":15,"s1":-0.0017957493909528922,"s2":-0.001490648229930505,"s3":-0.0024884321541917857},
{"x":16,"s1":0.0009570647170657323,"s2":-0.008647684651128803,"s3":0.005075062524047618},
{"x":17,"s1":-0.0006096006233673927,"s2":0.004270510780181128,"s3":-0.005557209702336054},
{"x":18,"s1":-0.00425737539451084,"s2":0.0009655768547482217,"s3":0.005926729541739964},
{"x":19,"s1":0.0019740196780101424,"s2":-0.003342290423041073,"s3":0.0009800331149750813},
{"x":20,"s1":-0.0033863957733593847,"s2":-0.0005900354210049163,"s3":0.0005353983183622608},
{"x":21,"s1":-0.002874975786411319,"s2":0.0003546389609743005,"s3":0.003342097462489411},
{"x":22,"s1":-0.0004958352818992029,"s2":0.0020455094733145087,"s3":0.004264948385769284},
{"x":23,"s1":-0.00010485494117295149,"s2":0.0037933428150278797,"s3":-0.0021164713491448653},
{"x":24,"s1":0.0030144245836087637,"s2":-0.005864430325431218,"s3":0.000988990562803064},
{"x":25,"s1":-0.0016601881175812652,"s2":-0.002094851413412501,"s3":-0.0010751985494769018},
{"x":26,"s1":-0.0006120805919187328,"s2":0.00227075528546851,"s3":-0.003125067160344343},
{"x":27,"s1":-0.0003604065824064774,"s2":-0.0006675141513469978,"s3":-0.0007547734201182979},
{"x":28,"s1":-0.00047602854189783073,"s2":0.0007668236707206234,"s3":0.003392684621613763},
{"x":29,"s1":0.0032782685165407893,"s2":-0.005494977009457347,"s3":-0.0004474854582813939},
{"x":30,"s1":-0.004595000448341313,"s2":0.0045360769545144865,"s3":-0.001426257953123048},
{"x":31,"s1":0.0030395252569137008,"s2":0.0007469644155204415,"s3":0.007882890960335665},
{"x":32,"s1":-0.0023477818441177962,"s2":0.0009540039418229052,"s3":-0.0018619850154802872},
{"x":33,"s1":0.00010165943449178379,"s2":-0.0006883620129074345,"s3":-0.0003773499616422191},
{"x":34,"s1":-0.002411549626874558,"s2":0.002125360626572301,"s3":-0.005502180402133455},
{"x":35,"s1":0.0017797716332148016,"s2":-0.0024421593119058173,"s3":-0.001468213377901356},
{"x":36,"s1":0.00019036746713365399,"s2":-0.0037886371890596448,"s3":0.008262248736559246},
{"x":37,"s1":-0.0005677401727140811,"s2":0.004315792285868141,"s3":-0.003634658426071631},
{"x":38,"s1":-0.003750844667438029,"s2":0.003919158399560125,"s3":0.0005236706556133322},
{"x":39,"s1":0.006343872723593201,"s2":-0.00463358358327067,"s3":-0.0023222998962474997},
{"x":40,"s1":-0.0007042400561176468,"s2":-0.0010281760705065823,"s3":-0.0011489900132943078},
{"x":41,"s1":-0.004587839811762692,"s2":0.005803086648208234,"s3":-0.0057251500450006595},
{"x":42,"s1":-0.0006225029259808766,"s2":0.0024954440390110274,"s3":0.0003463455170867922},
{"x":43,"s1":0.003072488337575955,"s2":-0.001815227639892065,"s3":-0.00021731854969251761},
{"x":44,"s1":0.002340759004371462,"s2":0.0018589503124024388,"s3":-0.005177399438450563},
{"x":45,"s1":0.002477896231702543,"s2":0.0019565000811377197,"s3":-0.00025222273136652683},
{"x":46,"s1":0.004234916330504995,"s2":-0.003743988667985144,"s3":0.003230249603695906},
{"x":47,"s1":-0.000354499690106734,"s2":0.004490959996617179,"s3":-0.00046849144575728365},
{"x":48,"s1":-0.0001377774104034817,"s2":0.0021156807093729727,"s3":-0.0017784258709188073},
{"x":49,"s1":0.0018744560730754763,"s2":0.0008172210215343634,"s3":-0.00550312207081817},
{"x":50,"s1":-0.0013072203504494763,"s2":-0.002319002351774897,"s3":0.0021468347647878357},
{"x":51,"s1":-0.0014104002059994358,"s2":-9.098691849984008e-5,"s3":-0.0028155725708049386},
{"x":52,"s1":7.850909577837063e-5,"s2":-0.0014558302063961885,"s3":-0.0006941741452463478},
{"x":53,"s1":-0.001974943570106217,"s2":0.0020930100588695613,"s3":0.0010594387469658527},
{"x":54,"s1":9.269329576704912e-5,"s2":0.0037996034721088116,"s3":-0.004585066826733007},
{"x":55,"s1":2.981769327214663e-5,"s2":-0.003412564489517414,"s3":-0.0002769538451181124},
{"x":56,"s1":0.0015323404589678898,"s2":-0.003491498848351102,"s3":0.0036993087705293813},
{"x":57,"s1":-0.00037175141427338163,"s2":0.001995066170957736,"s3":-0.0031155243210533347},
{"x":58,"s1":-0.0007982556755103173,"s2":-0.0027774457817129872,"s3":0.0009199275895397024},
{"x":59,"s1":0.002803891589320244,"s2":-0.005261719003502797,"s3":-1.9937642290367995e-5},
{"x":60,"s1":-0.0035167860923225815,"s2":-0.00039301995756917823,"s3":0.0022987993013786692},
{"x":61,"s1":0.001505940775293855,"s2":-0.0020813573474277583,"s3":-0.0022854918259800306},
{"x":62,"s1":0.002130124647482906,"s2":0.0020276327821112687,"s3":-0.002767965623182881},
{"x":63,"s1":-0.001235135972109397,"s2":0.002692480427750021,"s3":-0.0020276691621085507},
{"x":64,"s1":-0.00047212464235500825,"s2":0.0012366369799479467,"s3":-0.004437243227268738},
{"x":65,"s1":0.001037037010902634,"s2":0.00047198385885435887,"s3":-0.0028188469021790184},
{"x":66,"s1":-0.0015472613981485804,"s2":-0.0001894895126066537,"s3":-0.004636447411602421},
{"x":67,"s1":-0.00025280297895003686,"s2":-0.0006828329200896517,"s3":-0.0005829667771771218},
{"x":68,"s1":-0.0005334167401769874,"s2":-0.005162202845886896,"s3":-0.0016890317039112228},
{"x":69,"s1":-0.0006080528746712027,"s2":0.0029254905309605704,"s3":-0.0021023907457486547},
{"x":70,"s1":0.00042464649645801097,"s2":-0.002529390916742025,"s3":0.0014789002904335496},
{"x":71,"s1":0.003975377531677949,"s2":-0.0006936588693389959,"s3":-0.005185704866634637},
{"x":72,"s1":-0.0002590237547237235,"s2":-0.006135991945351292,"s3":0.0036829479419042514},
{"x":73,"s1":0.0012244604390789881,"s2":-0.0019986690627083236,"s3":0.0007034042972904084},
{"x":74,"s1":0.0019465981032587283,"s2":-0.0015061010674647757,"s3":0.0001319082402495908},
{"x":75,"s1":0.0014472768898119975,"s2":-0.004018889624363764,"s3":0.002295884735490519},
{"x":76,"s1":0.0021492229113736485,"s2":-0.003607013367913454,"s3":0.006879052924078758},
{"x":77,"s1":0.0014801185442670072,"s2":-0.0015211703129803715,"s3":-0.003356377054580725},
{"x":78,"s1":0.0020636438796623876,"s2":-0.005578868420763026,"s3":0.0023368535024147277},
{"x":79,"s1":0.0011001262391110785,"s2":-2.398407127558784e-5,"s3":-0.003918694532580965},
{"x":80,"s1":-0.00045877577559269534,"s2":-0.0032419910988569153,"s3":0.003342363899647328},
{"x":81,"s1":0.0003813557269180453,"s2":-0.004990623278447046,"s3":0.0036027163546169423},
{"x":82,"s1":0.00034275166955034786,"s2":-0.0033261266196544523,"s3":-0.0004952932573073191},
{"x":83,"s1":0.0004535431367995716,"s2":-0.001615023819504566,"s3":2.4748635908521804e-6},
{"x":84,"s1":-0.00011726589757875885,"s2":0.0010733775602368265,"s3":0.00320522694716025},
{"x":85,"s1":-0.0001421035705028194,"s2":0.004752149866218582,"s3":-2.467536090485902e-5},
{"x":86,"s1":0.003540036464991996,"s2":-0.0015824338535582738,"s3":-0.002248525850369688},
{"x":87,"s1":0.0025193515456216026,"s2":-0.0018314584569812712,"s3":-0.0027209904145052474},
{"x":88,"s1":-0.0014658126813025564,"s2":-0.0006416484505076903,"s3":-0.0030936101129457726},
{"x":89,"s1":0.0005439941097599711,"s2":-0.0008576804116305605,"s3":0.0013185147594056371},
{"x":90,"s1":0.001970455970704802,"s2":0.0012149653191692493,"s3":0.0007410216717053671},
{"x":91,"s1":0.002921445162920573,"s2":0.0002458931275429091,"s3":-0.0025791099274724396},
{"x":92,"s1":0.00033443832904640975,"s2":-0.0005242120807424129,"s3":0.002175453501509581},
{"x":93,"s1":0.00019452207932335312,"s2":-0.003842830519709406,"s3":0.0005696620487529898},
{"x":94,"s1":0.00026477026449814333,"s2":0.004309652927689662,"s3":0.00017914371333804373},
{"x":95,"s1":0.0019447578895996915,"s2":0.0005119159908607455,"s3":-0.005289884252578672},
{"x":96,"s1":0.002903972382346153,"s2":-0.007489634891738895,"s3":0.0050592028847195915},
{"x":97,"s1":-0.0012731440327597029,"s2":0.0051114572228888305,"s3":-0.0028879347102001383},
{"x":98,"s1":0.0009374799633620171,"s2":-0.0010778293610655292,"s3":0.003941290785128284},
{"x":99,"s1":0.0070919996872873415,"s2":-0.009335873784185758,"s3":0.002945178101863783},
{"x":100,"s1":-0.001900593379448915,"s2":0.0033900843971954846,"s3":0.0019158171381386596},
{"x":101,"s1":-0.00045572650084118937,"s2":-0.0007757140973100575,"s3":0.001702861424402895},
{"x":102,"s1":-0.002014709128987095,"s2":0.005019609809194966,"s3":-0.0003842056574219735},
{"x":103,"s1":0.00172441094431681,"s2":0.0008497330653414474,"s3":0.0025153753520121536},
{"x":104,"s1":-0.0025182432770553724,"s2":0.002651956680120386,"s3":0.0012662019151040487},
{"x":105,"s1":-0.001830279985778154,"s2":-0.0006535846571572543,"s3":0.004421512308750299},
{"x":106,"s1":-0.0035957749306533065,"s2":0.005717859334988339,"s3":0.00012595568846167826},
{"x":107,"s1":0.0006243849651650405,"s2":0.0011327045861601987,"s3":-0.002435879247220555},
{"x":108,"s1":-0.0012306870319795259,"s2":-0.00283607611127599,"s3":0.004269135124981784},
{"x":109,"s1":8.899573823715737e-5,"s2":0.001739297033888232,"s3":-0.0006656268060865482},
{"x":110,"s1":-0.0017385378368736373,"s2":0.0015416512779958943,"s3":0.004164435603294365},
{"x":111,"s1":0.005714785122557327,"s2":-0.005326532471879687,"s3":0.005198543299578748},
{"x":112,"s1":0.0013293952727390936,"s2":-0.0010683486855034233,"s3":0.003561094718761053},
{"x":113,"s1":0.0007458784787903027,"s2":0.0011474131273370885,"s3":0.001877862519909336},
{"x":114,"s1":0.004829235709193958,"s2":-0.008668901279049502,"s3":-0.0015036783187609621},
{"x":115,"s1":1.7330404687629055e-5,"s2":0.002509424211527802,"s3":-0.0011077031881732802},
{"x":116,"s1":-1.4740170218733868e-5,"s2":0.000488316171228864,"s3":0.003630758330937931},
{"x":117,"s1":-0.0011333330617081033,"s2":0.00718528151302416,"s3":-0.005712579616970963},
{"x":118,"s1":0.0037944692844630377,"s2":-0.004937491673329322,"s3":0.006643183210519111},
{"x":119,"s1":-0.0006230577188853638,"s2":-0.0006917109347033818,"s3":0.001760894688164232},
{"x":120,"s1":-0.0017540781479961865,"s2":0.0016332068910852324,"s3":0.005162990306793918},
{"x":121,"s1":0.0002716082103315543,"s2":0.005544994733866458,"s3":-0.0028703483344913877},
{"x":122,"s1":0.0009850216207332207,"s2":-0.004727784150848459,"s3":0.004839427645200185},
{"x":123,"s1":0.0006712966917207173,"s2":0.002332821051777875,"s3":-0.002014046577867516},
{"x":124,"s1":-0.0018251972560016454,"s2":0.005095408309601958,"s3":-0.004264711666947843},
{"x":125,"s1":-0.0020568407988342152,"s2":-0.0046491148486087555,"s3":0.004896575804034753},
{"x":126,"s1":-0.0003847318570373641,"s2":0.0010639351163552442,"s3":-0.003420822851633018},
{"x":127,"s1":-0.0014390842098738433,"s2":0.0009362591299299591,"s3":0.0008330418448740013},
{"x":128,"s1":0.0018085693774509762,"s2":-0.006106829521477316,"s3":0.0021069765776896726},
{"x":129,"s1":0.0002598604079442913,"s2":0.0013078432218511641,"s3":-0.00353077242629462},
{"x":130,"s1":0.0020003035061887274,"s2":-0.0015666010114599271,"s3":0.0030886297640315406},
{"x":131,"s1":0.0030983324443766983,"s2":-0.0023372921305558876,"s3":0.00446412882043414},
{"x":132,"s1":-0.003747710077381331,"s2":0.0029333127679900977,"s3":0.000942719476941789},
{"x":133,"s1":0.002419298009353048,"s2":-0.007799306166410124,"s3":0.0025031670292931197},
{"x":134,"s1":0.0043910872854376875,"s2":-0.0004865310582782931,"s3":-0.004024863076675864},
{"x":135,"s1":0.0012300725975246396,"s2":0.00532356687632129,"s3":-0.00436666276438083},
{"x":136,"s1":-0.0016888291146682183,"s2":-0.00020602853302708024,"s3":0.007899371003282018},
{"x":137,"s1":0.0010612484706898273,"s2":-0.0020023989615806795,"s3":-0.0016441048377294901},
{"x":138,"s1":-0.0012329064991640918,"s2":-0.0016554877017001964,"s3":0.003925064886692177},
{"x":139,"s1":0.0013934667575566943,"s2":0.00015499934010794784,"s3":0.002291291484698759},
{"x":140,"s1":-0.0011633007318782487,"s2":-0.0050529303353013455,"s3":-0.001151627095627544},
{"x":141,"s1":-0.0004722506535721512,"s2":0.0027611155764343852,"s3":-0.004192656238203293},
{"x":142,"s1":-0.0029188087573560786,"s2":-0.0033473890497911305,"s3":0.00807125257916039},
{"x":143,"s1":0.0015984637114184576,"s2":0.000144386761476133,"s3":-0.005016121334800715},
{"x":144,"s1":-0.0003397826123476247,"s2":-0.002960643666324563,"s3":0.003987070748035638},
{"x":145,"s1":0.0010207377515524558,"s2":-0.006546199284292874,"s3":0.010236866806726756},
{"x":146,"s1":0.0008727352512607266,"s2":0.0032973401052635463,"s3":-0.006603121154343901},
{"x":147,"s1":-0.0007716317160388317,"s2":0.00043669101431198986,"s3":0.0027172573298580396},
{"x":148,"s1":0.000940204062479247,"s2":0.0013355972983567456,"s3":0.0007523226767492278},
{"x":149,"s1":0.001469531020392766,"s2":-0.003150313549079049,"s3":0.002244729117022468},
{"x":150,"s1":-0.0021294230789956226,"s2":-0.0023798359235828546,"s3":0.005192010253549993},
{"x":151,"s1":0.0024326951064166814,"s2":-0.002844475140029237,"s3":0.0017307288422837319},
{"x":152,"s1":-0.0027111519703424116,"s2":-0.001100923826518942,"s3":0.004518158244393429},
{"x":153,"s1":0.0014745181944739436,"s2":-0.0008295565623329748,"s3":0.0009383863444247109},
{"x":154,"s1":-4.67344850480931e-5,"s2":-0.0025304967022715627,"s3":-0.006669832368453815},
{"x":155,"s1":-0.0015991588921640794,"s2":0.002277098010389409,"s3":0.0016818594615338137},
{"x":156,"s1":-0.0006163469263067672,"s2":0.0005833208803150898,"s3":0.007831612479035173},
{"x":157,"s1":0.002106983709006565,"s2":-0.009026745517926179,"s3":0.0012338866213377037},
{"x":158,"s1":-0.0010598533133651963,"s2":0.0052334339009410535,"s3":-0.0054690839805392345},
{"x":159,"s1":0.00018021647517851668,"s2":0.006941308980708161,"s3":0.0023535802625321324},
{"x":160,"s1":0.0027252251210504817,"s2":-0.004856172790311621,"s3":-0.0027649770325655267},
{"x":161,"s1":0.0004811815650371281,"s2":0.0032458132135221194,"s3":-0.00026849028029425224},
{"x":162,"s1":-0.0007456686186612784,"s2":0.0015485501699944722,"s3":0.0022787957796439463},
{"x":163,"s1":0.0021413032180359745,"s2":-0.0031886150258390524,"s3":0.004840383621979646},
{"x":164,"s1":-0.0010848133459341524,"s2":0.003735083146178822,"s3":-0.0035299882810372286},
{"x":165,"s1":0.0005458945470658559,"s2":0.0005529878529607729,"s3":-0.0011586776279162735},
{"x":166,"s1":0.0010781101281555918,"s2":0.0019597752017381205,"s3":-0.004247959939453275},
{"x":167,"s1":-0.0005165271819240094,"s2":0.005597938708537706,"s3":-0.0002203768071257746},
{"x":168,"s1":0.0035416120178793577,"s2":-0.005743473039918115,"s3":0.0001082564737499512},
{"x":169,"s1":0.0013803154540626692,"s2":0.003763941833782169,"s3":-0.007951544869186648},
{"x":170,"s1":-0.0003457895596975006,"s2":-0.00023697671175783086,"s3":0.005548081704348836},
{"x":171,"s1":0.004243099784645798,"s2":0.003372082869401695,"s3":-0.0022732907707259057},
{"x":172,"s1":0.0016423573622956684,"s2":0.005738962249820988,"s3":-0.012688867947139026},
{"x":173,"s1":0.0005301317850554862,"s2":0.0025034824089358184,"s3":-0.00015337291486944564},
{"x":174,"s1":0.0008656437575129327,"s2":-0.003559774967136417,"s3":0.003444397857478053},
{"x":175,"s1":0.0022036315100242305,"s2":0.002216702441533635,"s3":-0.00071533859276315},
{"x":176,"s1":-0.0005287394682711816,"s2":0.00590469505502907,"s3":-0.0013725073907753485},
{"x":177,"s1":0.0013611457731650726,"s2":-0.003668008195945421,"s3":0.002989851761734565},
{"x":178,"s1":-0.00016012094878293157,"s2":0.003836866368398151,"s3":-0.000548285114477292},
{"x":179,"s1":0.0008917544862101607,"s2":-0.001898241758401717,"s3":-0.004059867579110669},
{"x":180,"s1":0.0018144167322930033,"s2":-0.005045436960676213,"s3":-0.00026023589609969243},
{"x":181,"s1":-0.0028771017503743364,"s2":0.002648985884896169,"s3":-0.0016227115354236505},
{"x":182,"s1":-0.003672685545238515,"s2":0.0039061821385953195,"s3":-0.0009379841923273379},
{"x":183,"s1":0.004561226258122504,"s2":-0.0021292319969070037,"s3":-0.00463989609709615},
{"x":184,"s1":-0.0006120903180778662,"s2":0.003832251462382097,"s3":-0.003602228788594172},
{"x":185,"s1":0.003509325600920493,"s2":-0.0033517016210495502,"s3":-0.0028148444625316653},
{"x":186,"s1":0.000554008732521495,"s2":-0.0019681948047525952,"s3":-0.0008125572127500212},
{"x":187,"s1":0.0011400917164767076,"s2":-0.0059023213061969075,"s3":0.004062837510358823},
{"x":188,"s1":0.0019617540686357625,"s2":-7.441359755332351e-5,"s3":-0.0014975768659278592},
{"x":189,"s1":-0.00216322606058427,"s2":0.002797990996912334,"s3":-0.006360839944048633},
{"x":190,"s1":0.0024642405536998797,"s2":-0.004001160674333346,"s3":-0.0028747282984696075},
{"x":191,"s1":0.0013046545695986375,"s2":-0.0016178342233925953,"s3":0.0034569987787823556},
{"x":192,"s1":0.0015161304216767778,"s2":0.002941488831278729,"s3":-0.0026285326010662617},
{"x":193,"s1":0.0013050908225970444,"s2":0.00011447891759320628,"s3":0.005559971465756838},
{"x":194,"s1":1.3927221064559738e-5,"s2":-0.000504180254105173,"s3":0.0025508682187141535},
{"x":195,"s1":-0.000952399338417519,"s2":0.0016323574975140856,"s3":-0.0065786242752740864},
{"x":196,"s1":-0.002472715982609685,"s2":0.0029690126350816618,"s3":-0.0031081284785185494},
{"x":197,"s1":0.0035163634020025135,"s2":-0.006376419221683842,"s3":0.0024744978251465726},
{"x":198,"s1":-0.0005684611344585257,"s2":-0.0011771738181922341,"s3":0.0005800417088552721},
{"x":199,"s1":-0.0015280472924978023,"s2":-0.0007090417028699439,"s3":0.0021844955171313376},
{"x":200,"s1":0.002602800328265993,"s2":-0.002807197998045096,"s3":-0.007717703586726504},
{"x":201,"s1":0.0004475635833522757,"s2":-0.0015100026298316424,"s3":-0.002611716054989291},
{"x":202,"s1":-0.0005351955014010971,"s2":0.0008726784287529485,"s3":-0.0011747486856679473},
{"x":203,"s1":0.0029383349263069126,"s2":-0.00782987356741829,"s3":0.003969683020284543},
{"x":204,"s1":-0.00034755274231458556,"s2":-0.0002841720239582976,"s3":-0.004403601696619033},
{"x":205,"s1":0.002037917992503923,"s2":-0.0018301027637922017,"s3":-0.002309363021360282},
{"x":206,"s1":0.0029154188187756765,"s2":-0.007609396271340812,"s3":0.0022504440107742668},
{"x":207,"s1":-0.00037793200909817066,"s2":-0.001893145862330703,"s3":0.0036335199882276824},
{"x":208,"s1":0.001611225202274571,"s2":-0.003337824582607792,"s3":0.003097061427399764},
{"x":209,"s1":0.0028005481310691936,"s2":-0.003565433445246428,"s3":-0.000914510986505284},
{"x":210,"s1":0.0032532213207852614,"s2":-0.0026318477786432034,"s3":-0.004886143425852575},
{"x":211,"s1":-0.00312526466799429,"s2":0.00204696523594864,"s3":-0.0007238249621673126},
{"x":212,"s1":0.000441290102822659,"s2":-0.0021639143344616162,"s3":0.0056499483159616},
{"x":213,"s1":0.0014554476568070262,"s2":-0.00027941843145064423,"s3":-0.003052006567979112},
{"x":214,"s1":-0.0028372206863816617,"s2":-0.000867699871716199,"s3":0.002089142708392663},
{"x":215,"s1":0.0013336697698029057,"s2":0.0019246712958133814,"s3":-0.008530663589840962},
{"x":216,"s1":-0.00017168708795115944,"s2":6.331317016349198e-5,"s3":2.5752766567489044e-5},
{"x":217,"s1":0.00035198898188160317,"s2":-0.0015833261210966756,"s3":0.008055059654306466},
{"x":218,"s1":-0.0010055551449093094,"s2":0.003122949955145302,"s3":-0.0023458451732725166},
{"x":219,"s1":0.000941648397815295,"s2":-0.003956603326392494,"s3":0.00920127505864857},
{"x":220,"s1":0.001975134406161125,"s2":-0.0012292852191558177,"s3":-0.010927314815320466},
{"x":221,"s1":0.003106163894323391,"s2":-0.001196086244950057,"s3":-0.009714628343213402},
{"x":222,"s1":-0.002404096019917118,"s2":0.0006211338045900565,"s3":0.00934414245616983},
{"x":223,"s1":0.0034917598715966044,"s2":-0.00272562379269269,"s3":0.00392738293962775},
{"x":224,"s1":-0.003063941848187593,"s2":-0.0019584861291980105,"s3":-0.000936256153516903},
{"x":225,"s1":0.002988753180860049,"s2":0.0006278959576442331,"s3":-0.0007988880481776765},
{"x":226,"s1":9.20208377850796e-5,"s2":-0.0073329200914445496,"s3":0.004023739754889006},
{"x":227,"s1":-0.0015354635382108996,"s2":0.0008712499834581345,"s3":-0.00021625727124152146},
{"x":228,"s1":-0.0012730612878688536,"s2":0.00025831202470057325,"s3":0.00046899111807546584},
{"x":229,"s1":0.002589590047434749,"s2":-0.00786924268208448,"s3":0.005745489102120714},
{"x":230,"s1":-0.0010362953216561108,"s2":-0.0014326907271961945,"s3":-0.0013030296295144703},
{"x":231,"s1":0.0005475586574004679,"s2":-0.004858579702903151,"s3":-0.008064908416528873},
{"x":232,"s1":-0.0009547013881561396,"s2":-0.0013082866542036072,"s3":0.0031976982757741697},
{"x":233,"s1":-0.0006397882472748909,"s2":-0.0018505065610136258,"s3":0.0034836668956734445},
{"x":234,"s1":0.0014200764703423264,"s2":0.00028448144364323635,"s3":0.007714652963858026},
{"x":235,"s1":0.004033748629130181,"s2":-0.0030463799567183275,"s3":-0.0066943510011031595},
{"x":236,"s1":-0.002749216997133519,"s2":0.0018439844447754546,"s3":0.003344651667670993},
{"x":237,"s1":0.0002680691425222758,"s2":-0.0026979331482365216,"s3":0.007153556769142325},
{"x":238,"s1":-0.0013531855354611492,"s2":0.004030710454322756,"s3":-0.0028525216364506667},
{"x":239,"s1":-0.0013552265808101775,"s2":0.0029118349761973394,"s3":0.0013466391876985045},
{"x":240,"s1":0.003483570891015973,"s2":-0.0028515543552226214,"s3":0.0006215863240275432},
{"x":241,"s1":0.000916561096506399,"s2":0.0021403314449595454,"s3":-0.007158554236662863},
{"x":242,"s1":0.00041570873066172203,"s2":-0.001716839053256298,"s3":0.0025783800923293233},
{"x":243,"s1":0.002646826167863726,"s2":-8.797805346529524e-5,"s3":0.0029315466537272253},
{"x":244,"s1":-0.0014328594618628193,"s2":0.009158754373967733,"s3":-0.00393669586491284},
{"x":245,"s1":0.003931708455150471,"s2":-0.004282239568850621,"s3":0.006204608692184427},
{"x":246,"s1":0.001385259128546775,"s2":-0.003622286977155418,"s3":0.0012380315648766226}];
    const series = [{"name":"INDPRO","color":"#1f77b4","key":"s1","dash":""},{"name":"UNRATE","color":"#ff7f0e","key":"s2","dash":""},{"name":"CPI","color":"#2ca02c","key":"s3","dash":""}];
    const mode = 'stacked';

    const container = d3.select('#bhd_bar_59');
    const W = Math.max(container.node().clientWidth - 24, 280);
    const margin = {top:10, right:15, bottom:35, left:55};
    const w = W - margin.left - margin.right;
    const h = Math.min(w * 0.6, 250);

    const svg = container.append('svg').attr('width', W).attr('height', h + margin.top + margin.bottom);
    const g = svg.append('g').attr('transform', 'translate('+margin.left+','+margin.top+')');

    const keys = series.map(s => s.key);
    const x = d3.scaleBand().domain(data.map(d=>d.x)).range([0,w]).padding(0.15);

    let yMin = 0, yMax = 0;
    if(mode === 'stacked') {
        const stack = d3.stack().keys(keys).order(d3.stackOrderNone).offset(d3.stackOffsetDiverging);
        const stacked = stack(data);
        stacked.forEach(layer => layer.forEach(d => {
            yMin = Math.min(yMin, d[0], d[1]);
            yMax = Math.max(yMax, d[0], d[1]);
        }));
        const yPad = (yMax - yMin) * 0.08 || 1;
        const y = d3.scaleLinear().domain([yMin - yPad, yMax + yPad]).range([h, 0]);

        g.append('g').attr('class','grid').call(d3.axisLeft(y).tickSize(-w).tickFormat(''));
        g.selectAll('.layer').data(stacked).join('g').attr('class','layer')
            .attr('fill', (d,i) => series[i].color)
            .selectAll('rect').data(d => d).join('rect')
            .attr('x', d => x(d.data.x))
            .attr('y', d => y(Math.max(d[0], d[1])))
            .attr('height', d => Math.abs(y(d[0]) - y(d[1])))
            .attr('width', x.bandwidth());

        // Zero line
        g.append('line').attr('x1',0).attr('x2',w)
            .attr('y1',y(0)).attr('y2',y(0))
            .attr('stroke','#333').attr('stroke-width',0.8);

        g.append('g').attr('class','axis').attr('transform','translate(0,'+h+')')
            .call(d3.axisBottom(x).tickValues(x.domain().filter((d,i) =>
                i % Math.max(1,Math.floor(data.length/8)) === 0)));
        g.append('g').attr('class','axis').call(d3.axisLeft(y).ticks(6));
    } else {
        // Grouped
        data.forEach(d => keys.forEach(k => {
            yMin = Math.min(yMin, d[k]||0);
            yMax = Math.max(yMax, d[k]||0);
        }));
        const yPad = (yMax - yMin) * 0.08 || 1;
        const y = d3.scaleLinear().domain([yMin - yPad, yMax + yPad]).range([h, 0]);
        const x1 = d3.scaleBand().domain(keys).range([0, x.bandwidth()]).padding(0.05);

        g.append('g').attr('class','grid').call(d3.axisLeft(y).tickSize(-w).tickFormat(''));
        g.selectAll('.group').data(data).join('g').attr('class','group')
            .attr('transform', d => 'translate('+x(d.x)+',0)')
            .selectAll('rect').data(d => keys.map(k => ({key:k, val:d[k]||0})))
            .join('rect')
            .attr('x', d => x1(d.key))
            .attr('y', d => y(Math.max(0, d.val)))
            .attr('height', d => Math.abs(y(0) - y(d.val)))
            .attr('width', x1.bandwidth())
            .attr('fill', d => series.find(s=>s.key===d.key).color);

        g.append('line').attr('x1',0).attr('x2',w)
            .attr('y1',y(0)).attr('y2',y(0))
            .attr('stroke','#333').attr('stroke-width',0.8);

        g.append('g').attr('class','axis').attr('transform','translate(0,'+h+')')
            .call(d3.axisBottom(x).tickValues(x.domain().filter((d,i) =>
                i % Math.max(1,Math.floor(data.length/8)) === 0)));
        g.append('g').attr('class','axis').call(d3.axisLeft(y).ticks(6));
    }

    if('Period') g.append('text').attr('x',w/2).attr('y',h+30).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Period');
    if('Contribution') g.append('text').attr('transform','rotate(-90)')
        .attr('x',-h/2).attr('y',-42).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Contribution');

    // Legend
    if(series.length > 1) {
        const leg = g.append('g').attr('class','legend').attr('transform','translate(5,-5)');
        series.forEach((s,i) => {
            const gi = leg.append('g').attr('transform','translate('+(i*90)+',0)');
            gi.append('rect').attr('width',12).attr('height',12).attr('y',-6).attr('fill',s.color);
            gi.append('text').attr('x',16).attr('y',4).attr('font-size','10px').attr('fill','#555').text(s.name);
        });
    }

    // Tooltip
    svg.append('rect').attr('width',W).attr('height',h+margin.top+margin.bottom)
        .attr('fill','none').attr('pointer-events','all')
        .on('mousemove', function(evt) {
            const [mx] = d3.pointer(evt, g.node());
            const bands = x.domain();
            const idx = Math.min(Math.floor(mx / (w / bands.length)), bands.length-1);
            const d = data[Math.max(0,idx)];
            if(!d) return;
            let html = '<b>'+d.x+'</b>';
            series.forEach(s => { if(d[s.key]!==undefined) html += '<br>'+s.name+': '+fmt(d[s.key]); });
            showTip(evt, html);
        })
        .on('mouseout', hideTip);
})();

(function() {
    const data = [{"x":1,"actual":-0.0017753334383439068,"recon":-0.001429488270071196},
{"x":2,"actual":0.0017443643377621498,"recon":0.0008352522367091227},
{"x":3,"actual":-0.0008905957739751003,"recon":0.0007600590328703132},
{"x":4,"actual":-0.0008813491066348433,"recon":-0.0002101268838217488},
{"x":5,"actual":0.0008601214828241055,"recon":-0.0014318471644784961},
{"x":6,"actual":-0.0017406235464711983,"recon":0.0006241412020674851},
{"x":7,"actual":0.0017226327038093459,"recon":0.004266457441440205},
{"x":8,"actual":-0.001731581556640549,"recon":-0.0029116302422117824},
{"x":9,"actual":0.0008557752764977167,"recon":-0.00010873388337343188},
{"x":10,"actual":0.0034121755492124706,"recon":0.004130709116085282},
{"x":11,"actual":-0.003434147695855927,"recon":-0.002388062177361916},
{"x":12,"actual":0.0016898344401505838,"recon":0.0010289111109800912},
{"x":13,"actual":-1.795477193056172e-5,"recon":-0.004545193705422584},
{"x":14,"actual":-1.7803573177488374e-5,"recon":0.0004985990500944875},
{"x":15,"actual":-1.7654276307510486e-5,"recon":-0.005889833143300963},
{"x":16,"actual":-0.0008511875981334072,"recon":-0.0015878273113873733},
{"x":17,"actual":-1.1129714737379004e-5,"recon":-0.0011437909737168853},
{"x":18,"actual":-1.1055824312933282e-5,"recon":0.0033635666532278864},
{"x":19,"actual":0.0008144404088756829,"recon":-0.0006756337761659929},
{"x":20,"actual":-0.000839049634874911,"recon":-0.002784334435310067},
{"x":21,"actual":0.0016271813085753095,"recon":0.001249863263826906},
{"x":22,"actual":0.0024159092474844712,"recon":0.00610453799386252},
{"x":23,"actual":-0.0024757402448782884,"recon":0.0013176762352609026},
{"x":24,"actual":-0.001633833395915829,"recon":-0.0013400747434580175},
{"x":25,"actual":-1.0389117917952717e-5,"recon":-0.005717427245927476},
{"x":26,"actual":-0.0032180236942007667,"recon":-0.000643760277185461},
{"x":27,"actual":0.002406740030565402,"recon":-0.0016306073851205705},
{"x":28,"actual":0.0023894322329276463,"recon":0.0036596071401593985},
{"x":29,"actual":-0.0008168594120121497,"recon":-0.002693278729969147},
{"x":30,"actual":-0.0008072245453369931,"recon":-0.0011151364751317572},
{"x":31,"actual":0.006284246935892135,"recon":0.011571723242220444},
{"x":32,"actual":-0.005542435920900424,"recon":-0.0027774046424102372},
{"x":33,"actual":0.0007626485627660884,"recon":-0.001190736696035063},
{"x":34,"actual":-0.002346449742278267,"recon":-0.004946889796715185},
{"x":35,"actual":-0.0007797102341688955,"recon":-0.0023846224243405543},
{"x":36,"actual":0.004627237916502658,"recon":0.0051641810534658605},
{"x":37,"actual":-0.0015693227377626684,"recon":0.0007241160603399409},
{"x":38,"actual":0.0037854890422739373,"recon":0.0006537658402730527},
{"x":39,"actual":-0.0015781655934086203,"recon":0.0001620699066940906},
{"x":40,"actual":-4.613847981271846e-5,"recon":-0.002891848299841087},
{"x":41,"actual":-0.004523137428873447,"recon":-0.004320448338496864},
{"x":42,"actual":0.001486389803310395,"recon":0.002336496598347942},
{"x":43,"actual":-1.3881550946948096e-5,"recon":0.0008721334903756498},
{"x":44,"actual":-0.0029767438168493143,"recon":-0.0009485515586878566},
{"x":45,"actual":-0.0007421150618878158,"recon":0.0037901914693436504},
{"x":46,"actual":0.0022230464879466894,"recon":0.00397796137019634},
{"x":47,"actual":0.001471084052194982,"recon":0.003473379164605375},
{"x":48,"actual":-0.0007486203103841405,"recon":0.00013932429608493453},
{"x":49,"actual":-0.001476002250398345,"recon":-0.0028340300462589376},
{"x":50,"actual":0.0014630454419188865,"recon":-0.0012596750319171079},
{"x":51,"actual":-8.574729842614204e-6,"recon":-0.004612250281042836},
{"x":52,"actual":-0.0014651892277761647,"recon":-0.0013343975539371203},
{"x":53,"actual":0.0029048538241145394,"recon":0.001275379240393358},
{"x":54,"actual":-0.0014650905337623144,"recon":-0.0004448414719271298},
{"x":55,"actual":-0.0021752254168685425,"recon":-0.003482198683320305},
{"x":56,"actual":0.001443520747947069,"recon":0.002572410379485041},
{"x":57,"actual":0.001434164088504275,"recon":-0.0013453235811007485},
{"x":58,"actual":-0.0014466127765677683,"recon":-0.002321292074694687},
{"x":59,"actual":-4.63146053419905e-6,"recon":-0.0017239623985786684},
{"x":60,"actual":0.0007094191435532693,"recon":-0.0016891388154803865},
{"x":61,"actual":-8.151649206311617e-6,"recon":-0.002808422727888506},
{"x":62,"actual":-0.0007180804806976582,"recon":0.001838666459401863},
{"x":63,"actual":-4.539815315673934e-6,"recon":-0.0008173683841791791},
{"x":64,"actual":0.002114872703040227,"recon":-0.0036066995863982764},
{"x":65,"actual":-0.0014243994314462327,"recon":-0.0013699775223548036},
{"x":66,"actual":-0.0014124184136683482,"recon":-0.0062005352827092745},
{"x":67,"actual":0.0021010748169265625,"recon":-0.0017319983108586789},
{"x":68,"actual":-0.0014089081527579594,"recon":-0.0075597930295662735},
{"x":69,"actual":-0.0007019883851988595,"recon":0.0005553518821480552},
{"x":70,"actual":0.0020864621810989803,"recon":-0.0004255223153115051},
{"x":71,"actual":-0.0007053308889179988,"recon":-0.0021845104768010762},
{"x":72,"actual":-0.00208453863492597,"recon":-0.002238733403261235},
{"x":73,"actual":0.000691800843685364,"recon":0.00029311856693481873},
{"x":74,"actual":0.0006889306264676875,"recon":0.000980137769655575},
{"x":75,"actual":-0.0006937099301715932,"recon":-5.0555393714304085e-5},
{"x":76,"actual":0.002749130873053396,"recon":0.0061819906476151655},
{"x":77,"actual":-0.0013859073962603219,"recon":-0.0036228437955834005},
{"x":78,"actual":-0.0006907996280087758,"recon":-0.0005905683343629686},
{"x":79,"actual":-0.002052686317742136,"recon":-0.002475024066176979},
{"x":80,"actual":0.002730377122857064,"recon":-0.0004819912692942338},
{"x":81,"actual":-7.434664400562951e-6,"recon":-0.0011636726293748297},
{"x":82,"actual":-0.002043363771072393,"recon":-0.0033691330100879256},
{"x":83,"actual":0.0013563907977145462,"recon":-0.0010368372828677558},
{"x":84,"actual":0.0006722244517805009,"recon":0.004270088589885566},
{"x":85,"actual":0.0006667670796467462,"recon":0.004475332187981526},
{"x":86,"actual":0.0006600141956534245,"recon":4.265753296081023e-5},
{"x":87,"actual":-0.0020235766124940824,"recon":-0.002165448907089032},
{"x":88,"actual":-0.0013418304461128017,"recon":-0.004723434643708434},
{"x":89,"actual":0.002004230230830295,"recon":0.0012929759558178535},
{"x":90,"actual":-0.000673130828106494,"recon":0.004190209257234931},
{"x":91,"actual":0.0006606779932178952,"recon":0.0006918022744406404},
{"x":92,"actual":-7.063964640785514e-6,"recon":0.0024991380087565993},
{"x":93,"actual":-0.0006681836132438335,"recon":-0.0027297067149241335},
{"x":94,"actual":0.001974303244467457,"recon":0.004927115892591429},
{"x":95,"actual":-0.0019860669123801244,"recon":-0.002673379086575982},
{"x":96,"actual":-3.890316417454187e-6,"recon":0.0010170329028893659},
{"x":97,"actual":-0.0006589683894890896,"recon":0.0006663308899148936},
{"x":98,"actual":0.0006525184868495515,"recon":0.004356133576907043},
{"x":99,"actual":-0.0006568043560379877,"recon":0.0008304313637216179},
{"x":100,"actual":0.0013020746349914347,"recon":0.003305901448552262},
{"x":101,"actual":-0.0013071808463145373,"recon":0.0006638611408669448},
{"x":102,"actual":-1.6932170154859705e-6,"recon":0.0028914923845635397},
{"x":103,"actual":0.00388432643390324,"recon":0.004919908076651188},
{"x":104,"actual":-0.00324735739395976,"recon":0.0017103719294059012},
{"x":105,"actual":0.0012832553598149943,"recon":0.0019529008121337062},
{"x":106,"actual":0.0006304812020561101,"recon":0.0023711515876257247},
{"x":107,"actual":-0.0019310953122735341,"recon":-0.000703452794124244},
{"x":108,"actual":-3.6793390600919906e-6,"recon":0.0007498423502549801},
{"x":109,"actual":-3.665264431518267e-6,"recon":0.0011615614014437385},
{"x":110,"actual":-0.0006395813395343453,"recon":0.003861430839025421},
{"x":111,"actual":0.0019025393270881708,"recon":0.0059190059504603204},
{"x":112,"actual":-1.0052609325406081e-5,"recon":0.004283729735400195},
{"x":113,"actual":-9.989165751456142e-6,"recon":0.003918315695595528},
{"x":114,"actual":-0.000638264387432308,"recon":-0.004940193145257048},
{"x":115,"actual":-0.0006334767990034962,"recon":0.0013748125413076636},
{"x":116,"actual":-3.5421475219621357e-6,"recon":0.004312287513562267},
{"x":117,"actual":-0.0012543107536444609,"recon":0.00019834086028020642},
{"x":118,"actual":-3.916034732043272e-7,"recon":0.006033034393483231},
{"x":119,"actual":-0.0006255865077342548,"recon":0.0007356560308345757},
{"x":120,"actual":0.0018744147943507983,"recon":0.0050457954906643655},
{"x":121,"actual":-0.0006267539961957169,"recon":0.0032162318605751536},
{"x":122,"actual":0.0012430005142967104,"recon":0.0013367673029735273},
{"x":123,"actual":-6.187984790351209e-6,"recon":0.0007446740271788942},
{"x":124,"actual":-0.00062516073747787,"recon":-0.0005711794786955626},
{"x":125,"actual":-0.0006216886698338087,"recon":-0.0016529595942258923},
{"x":126,"actual":-0.0006193858790188855,"recon":-0.0028741137741342014},
{"x":127,"actual":0.0006170925666610927,"recon":0.0001942517955811783},
{"x":128,"actual":-0.001235330607991969,"recon":-0.0016440976352049019},
{"x":129,"actual":0.0,"recon":-0.0020714348401405553},
{"x":130,"actual":0.001233806448929009,"recon":0.0037216627197143373},
{"x":131,"actual":0.001229248983468878,"recon":0.005442344904473023},
{"x":132,"actual":-0.0012337989776680658,"recon":0.00034139689003084546},
{"x":133,"actual":0.0012247325068361903,"recon":-0.002888021408558257},
{"x":134,"actual":-0.0012292490656697908,"recon":0.00015565788568946016},
{"x":135,"actual":-0.0006129319844907499,"recon":0.0024552599794520026},
{"x":136,"actual":0.0018316875010704337,"recon":0.006261168022525862},
{"x":137,"actual":-0.001223983066214629,"recon":-0.0026278686582325815},
{"x":138,"actual":0.0006069721797734573,"recon":0.001577678963774574},
{"x":139,"actual":-3.3299645201267936e-6,"recon":0.0037460333773574415},
{"x":140,"actual":-0.001823154561514606,"recon":-0.006962500899121957},
{"x":141,"actual":0.0006069802917769707,"recon":-0.0017502466368003304},
{"x":142,"actual":0.006045599429250537,"recon":0.0017053384389036736},
{"x":143,"actual":-0.006049988560882902,"recon":-0.003390871134681915},
{"x":144,"actual":-0.0006025911601446055,"recon":0.0008608951699297996},
{"x":145,"actual":0.0042080014002046084,"recon":0.004913729902317366},
{"x":146,"actual":-0.0018113555556045213,"recon":-0.0023419592411456857},
{"x":147,"actual":0.0017837125871578152,"recon":0.0023513365992131816},
{"x":148,"actual":-0.0023941120502941615,"recon":0.0035689184757270844},
{"x":149,"actual":-3.1849878077139238e-6,"recon":0.0004215874347923129},
{"x":150,"actual":0.0005894189599748856,"recon":0.001224466302768716},
{"x":151,"actual":0.0005852266236017201,"recon":0.001566021980819385},
{"x":152,"actual":0.0011684409339398627,"recon":0.0006759865083895361},
{"x":153,"actual":0.001738971541225709,"recon":0.0017513305633002755},
{"x":154,"actual":-0.006450085833512809,"recon":-0.00906306473009197},
{"x":155,"actual":0.0023388399672104043,"recon":0.002368658201854541},
{"x":156,"actual":0.00407025469989275,"recon":0.00795748895779618},
{"x":157,"actual":-0.0029247351269861,"recon":-0.0057242495015170595},
{"x":158,"actual":-0.00289939315900245,"recon":-0.0007523284090584018},
{"x":159,"actual":0.00519781707361755,"recon":0.00931241976662693},
{"x":160,"actual":-0.003471197939630244,"recon":-0.004353061380365218},
{"x":161,"actual":-2.976075822225255e-6,"recon":0.0036835888344744663},
{"x":162,"actual":0.0005699359289339512,"recon":0.003216699373721916},
{"x":163,"actual":0.0034174588084159296,"recon":0.004047903541680012},
{"x":164,"actual":-0.003435723958379988,"recon":-0.0006213556047172924},
{"x":165,"actual":-0.0017072933731263618,"recon":-8.352444286445103e-5},
{"x":166,"actual":0.0011341076065223277,"recon":-0.0009705051273175269},
{"x":167,"actual":0.003386941436940738,"recon":0.005059274879273404},
{"x":168,"actual":-0.0028355474270282954,"recon":-0.0016492732951720619},
{"x":169,"actual":-0.003943187365570644,"recon":-0.002953956696801206},
{"x":170,"actual":0.001689665285127262,"recon":0.005506595683539227},
{"x":171,"actual":0.003938120420137636,"recon":0.005506118281926408},
{"x":172,"actual":-0.0067494801576843955,"recon":-0.005142812575800422},
{"x":173,"actual":0.002248138094947727,"recon":0.003055495354048297},
{"x":174,"actual":-3.1739739281277934e-7,"recon":0.0009398509745632009},
{"x":175,"actual":0.002253204325119107,"recon":0.003636756944224801},
{"x":176,"actual":-2.850153648203957e-6,"recon":0.0045451789853831505},
{"x":177,"actual":0.001118235796129241,"recon":0.0009244674769941213},
{"x":178,"actual":0.0016667284637854607,"recon":0.003378777005231725},
{"x":179,"actual":-0.0033569520741476566,"recon":-0.005164809527753678},
{"x":180,"actual":-0.000557879377479864,"recon":-0.0029491291409627046},
{"x":181,"actual":0.0016677470823447393,"recon":-0.00161741768014908},
{"x":182,"actual":0.0005492318606146185,"recon":-0.0004868529697281184},
{"x":183,"actual":-0.0011132566975851077,"recon":-0.0020083347463814754},
{"x":184,"actual":0.0005492754656621912,"recon":-0.00017089909709880205},
{"x":185,"actual":-0.000555685554776808,"recon":-0.002760325344040297},
{"x":186,"actual":-2.7320575526346147e-6,"recon":-0.0016845229896448656},
{"x":187,"actual":0.0027392583790168956,"recon":-0.000527850787537908},
{"x":188,"actual":0.0010707236080316207,"recon":0.0005709444196646751},
{"x":189,"actual":-0.0038288566016362324,"recon":-0.005661687248830131},
{"x":190,"actual":-0.005446332794130981,"recon":-0.0038696278335294473},
{"x":191,"actual":0.0021747825270352905,"recon":0.0030939911052360793},
{"x":192,"actual":0.002731793126854676,"recon":0.00206808603045781},
{"x":193,"actual":0.0021786442569711184,"recon":0.007225422616754785},
{"x":194,"actual":0.0010739307188858405,"recon":0.00234855818835185},
{"x":195,"actual":-0.0010987151606309808,"recon":-0.005935415270959837},
{"x":196,"actual":-0.004327837285243774,"recon":-0.0021142931402362776},
{"x":197,"actual":0.0016217678716188288,"recon":-0.00017160557966430638},
{"x":198,"actual":0.0021583702839196306,"recon":-0.000967113501810194},
{"x":199,"actual":0.0016043385908881547,"recon":8.52577645882144e-5},
{"x":200,"actual":-0.0021586226199197256,"recon":-0.007380298811619201},
{"x":201,"actual":-4.590207765886589e-6,"recon":-0.003776662716838278},
{"x":202,"actual":-0.0005380462080903925,"recon":-0.00029541661974671744},
{"x":203,"actual":0.002657720822680787,"recon":-0.0007354686500105345},
{"x":204,"actual":-0.0005473099907735701,"recon":-0.004797484596660346},
{"x":205,"actual":-0.00265434619923699,"recon":-0.0021648595584739653},
{"x":206,"actual":-0.0005295202035817681,"recon":-0.001985460664754797},
{"x":207,"actual":0.0026375486046843477,"recon":0.0015990148637549067},
{"x":208,"actual":0.0020886432803086663,"recon":0.001612164054190189},
{"x":209,"actual":-0.0005489818009465353,"recon":-0.001438559585939283},
{"x":210,"actual":-0.0047058910374122576,"recon":-0.003722756227349324},
{"x":211,"actual":-0.0005217845148388633,"recon":-0.0018547283218927758},
{"x":212,"actual":0.004688457209685026,"recon":0.004469338758295524},
{"x":213,"actual":-0.0005350214919834784,"recon":-0.0016781440680497567},
{"x":214,"actual":-0.0005292702243808733,"recon":-0.0014286833598476487},
{"x":215,"actual":-0.0036187765489552604,"recon":-0.005092133997316914},
{"x":216,"actual":0.0010327911409468982,"recon":0.000360954258542409},
{"x":217,"actual":0.005659640530090826,"recon":0.007006141649272861},
{"x":218,"actual":-3.7909411778613844e-5,"recon":-3.7576213529841914e-5},
{"x":219,"actual":0.007536434331387731,"recon":0.006388667200027325},
{"x":220,"actual":-0.012166644172496355,"recon":-0.009639541704395061},
{"x":221,"actual":-0.006543174213322622,"recon":-0.007855066293746129},
{"x":222,"actual":0.005035257365645585,"recon":0.008103086670203432},
{"x":223,"actual":0.006039273514243604,"recon":0.004931361316216843},
{"x":224,"actual":-0.005537643205254739,"recon":-0.005722399428235342},
{"x":225,"actual":0.0010017525850427589,"recon":0.003047919107701251},
{"x":226,"actual":0.003491632486491092,"recon":-0.002767607169993823},
{"x":227,"actual":-0.0020099385370686562,"recon":-0.0009482550190794139},
{"x":228,"actual":-0.0005043015696912789,"recon":-0.00026360132089186085},
{"x":229,"actual":0.0029553636384971327,"recon":0.0006544261351081452},
{"x":230,"actual":-0.0010102649554042387,"recon":-0.0032300959974770555},
{"x":231,"actual":-0.009344723028451796,"recon":-0.01246981413119292},
{"x":232,"actual":0.00047110267335970235,"recon":0.001476643441191298},
{"x":233,"actual":0.0049429184806495385,"recon":0.001188062301114185},
{"x":234,"actual":0.0049355991027209,"recon":0.00962422420728112},
{"x":235,"actual":-0.0037728651289015147,"recon":-0.005491123874273243},
{"x":236,"actual":0.002212943077307017,"recon":0.002910969836291937},
{"x":237,"actual":0.0013157983596601142,"recon":0.004678955529308303},
{"x":238,"actual":-0.0021904780112009803,"recon":0.0003669595034433092},
{"x":239,"actual":0.0011283071749250695,"recon":0.0031355067034437036},
{"x":240,"actual":-0.001810404477464722,"recon":0.001479876817323401},
{"x":241,"actual":-0.0005350597127780077,"recon":-0.0040823877325045724},
{"x":242,"actual":-0.001470779266562694,"recon":0.0018192004028130605},
{"x":243,"actual":0.003920367045320283,"recon":0.005687951932896344},
{"x":244,"actual":-0.0011501058443394996,"recon":0.003979364160056152},
{"x":245,"actual":0.004749669681774371,"recon":0.006040294661735218},
{"x":246,"actual":-0.004934340679924709,"recon":-0.0004941617917317179}];
    const series = [{"name":"Actual","color":"#1f77b4","key":"actual","dash":""},{"name":"Reconstructed","color":"#ff7f0e","key":"recon","dash":"6,3"}];
    const bands = [];
    const refLines = [];

    const container = d3.select('#bhd_line_60');
    const W = Math.max(container.node().clientWidth - 24, 280);
    const margin = {top:10, right:15, bottom:35, left:55};
    const w = W - margin.left - margin.right;
    const h = Math.min(w * 0.6, 250);

    const svg = container.append('svg').attr('width', W).attr('height', h + margin.top + margin.bottom);
    const g = svg.append('g').attr('transform', 'translate('+margin.left+','+margin.top+')');

    // Compute domains
    const xVals = data.map(d => d.x);
    const allYVals = [];
    series.forEach(s => data.forEach(d => { if(d[s.key]!==null) allYVals.push(d[s.key]); }));
    bands.forEach(b => data.forEach(d => {
        if(d[b.lo_key]!==null) allYVals.push(d[b.lo_key]);
        if(d[b.hi_key]!==null) allYVals.push(d[b.hi_key]);
    }));
    refLines.forEach(r => allYVals.push(r.value));

    const x = d3.scaleLinear().domain(d3.extent(xVals)).range([0,w]);
    const yExt = d3.extent(allYVals);
    const yPad = (yExt[1]-yExt[0])*0.08 || 1;
    const y = d3.scaleLinear().domain([yExt[0]-yPad, yExt[1]+yPad]).range([h,0]);

    // Grid
    g.append('g').attr('class','grid').call(d3.axisLeft(y).tickSize(-w).tickFormat(''));

    // Bands
    bands.forEach(b => {
        const area = d3.area()
            .x(d => x(d.x))
            .y0(d => y(d[b.lo_key]!==null ? d[b.lo_key] : 0))
            .y1(d => y(d[b.hi_key]!==null ? d[b.hi_key] : 0))
            .defined(d => d[b.lo_key]!==null && d[b.hi_key]!==null);
        g.append('path').datum(data).attr('d',area)
            .attr('fill',b.color).attr('opacity',b.alpha||0.15);
    });

    // Reference lines
    refLines.forEach(r => {
        g.append('line').attr('x1',0).attr('x2',w)
            .attr('y1',y(r.value)).attr('y2',y(r.value))
            .attr('stroke',r.color||'#999').attr('stroke-width',1)
            .attr('stroke-dasharray',r.dash||'4,3');
    });

    // Lines
    series.forEach(s => {
        const line = d3.line().x(d=>x(d.x)).y(d=>y(d[s.key]))
            .defined(d=>d[s.key]!==null);
        g.append('path').datum(data).attr('d',line)
            .attr('fill','none').attr('stroke',s.color).attr('stroke-width',1.8)
            .attr('stroke-dasharray',s.dash||'');
    });

    // Axes
    g.append('g').attr('class','axis').attr('transform','translate(0,'+h+')')
        .call(d3.axisBottom(x).ticks(Math.min(xVals.length,8)));
    g.append('g').attr('class','axis').call(d3.axisLeft(y).ticks(6));

    if('Period') g.append('text').attr('x',w/2).attr('y',h+30).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Period');
    if('Value') g.append('text').attr('transform','rotate(-90)')
        .attr('x',-h/2).attr('y',-42).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Value');

    // Legend
    if(series.length > 1) {
        const leg = g.append('g').attr('class','legend').attr('transform','translate(5,-5)');
        series.forEach((s,i) => {
            const gi = leg.append('g').attr('transform','translate('+(i*100)+',0)');
            gi.append('line').attr('x1',0).attr('x2',16).attr('y1',0).attr('y2',0)
                .attr('stroke',s.color).attr('stroke-width',2)
                .attr('stroke-dasharray',s.dash||'');
            gi.append('text').attr('x',20).attr('y',4).attr('font-size','10px')
                .attr('fill','#555').text(s.name);
        });
    }

    // Tooltip overlay
    svg.append('rect').attr('width',W).attr('height',h+margin.top+margin.bottom)
        .attr('fill','none').attr('pointer-events','all')
        .on('mousemove', function(evt) {
            const [mx] = d3.pointer(evt, g.node());
            const x0 = x.invert(mx);
            const idx = d3.minIndex(data, d => Math.abs(d.x - x0));
            const d = data[idx];
            let html = '<b>x='+fmt(d.x)+'</b>';
            series.forEach(s => { if(d[s.key]!==null) html += '<br>'+s.name+': '+fmt(d[s.key]); });
            showTip(evt, html);
        })
        .on('mouseout', hideTip);
})();

</script>
</body>
</html>